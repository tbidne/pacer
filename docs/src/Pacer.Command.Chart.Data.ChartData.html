<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NoScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html"><span class="hs-identifier">Pacer.Command.Chart.Data.ChartData</span></a></span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartData"><span class="hs-identifier">ChartData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartY"><span class="hs-identifier">ChartY</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartY1"><span class="hs-identifier">ChartY1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#mkChartData"><span class="hs-identifier">mkChartData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Asn</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl1'</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">all</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Empty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.html/Data.Sequence.NonEmpty.html"><span class="hs-identifier">Data.Sequence.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NESeq</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/logger-effectful-0.1-4c462c8d83799fc5c4900b79f30134a510b541d670854fe1dc3097beacce1d6c/share/doc/html/src/Effectful.Logger.Dynamic.html/Effectful.Logger.Dynamic.html"><span class="hs-identifier">Effectful.Logger.Dynamic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/logger-effectful-0.1-4c462c8d83799fc5c4900b79f30134a510b541d670854fe1dc3097beacce1d6c/share/doc/html/src/Effectful.Logger.Dynamic.html/Effectful.Logger.Dynamic.html#LogLevel"><span class="hs-identifier">LogLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/logger-effectful-0.1-4c462c8d83799fc5c4900b79f30134a510b541d670854fe1dc3097beacce1d6c/share/doc/html/src/Effectful.Logger.Dynamic.html/Effectful.Logger.Dynamic.html#LevelDebug"><span class="hs-identifier">LevelDebug</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/logger-effectful-0.1-4c462c8d83799fc5c4900b79f30134a510b541d670854fe1dc3097beacce1d6c/share/doc/html/src/Effectful.Logger.Dynamic.html/Effectful.Logger.Dynamic.html"><span class="hs-identifier">Effectful.Logger.Dynamic</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Logger</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Activity</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#Activity"><span class="hs-identifier">Activity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkActivity"><span class="hs-identifier">MkActivity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#datetime"><span class="hs-identifier">datetime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#distance"><span class="hs-identifier">distance</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#duration"><span class="hs-identifier">duration</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivities"><span class="hs-identifier">SomeActivities</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivities"><span class="hs-identifier">MkSomeActivities</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivitiesKey"><span class="hs-identifier">SomeActivitiesKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier">SomeActivity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier">MkSomeActivity</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Activity</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Activity</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html"><span class="hs-identifier">Pacer.Command.Chart.Data.ChartRequest</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartRequest"><span class="hs-identifier">ChartRequest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#chartType"><span class="hs-identifier">chartType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#filters"><span class="hs-identifier">filters</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#title"><span class="hs-identifier">title</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#y1Axis"><span class="hs-identifier">y1Axis</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#yAxis"><span class="hs-identifier">yAxis</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumPeriod"><span class="hs-identifier">ChartSumPeriod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumDays"><span class="hs-identifier">ChartSumDays</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumMonth"><span class="hs-identifier">ChartSumMonth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumWeek"><span class="hs-identifier">ChartSumWeek</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumYear"><span class="hs-identifier">ChartSumYear</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartType"><span class="hs-identifier">ChartType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartTypeDefault"><span class="hs-identifier">ChartTypeDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartTypeSum"><span class="hs-identifier">ChartTypeSum</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisType"><span class="hs-identifier">YAxisType</span></a></span><span>
</span><span id="line-34"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisDistance"><span class="hs-identifier">YAxisDistance</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisDuration"><span class="hs-identifier">YAxisDuration</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisPace"><span class="hs-identifier">YAxisPace</span></a></span><span>
</span><span id="line-37"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.html#FilterExpr"><span class="hs-identifier">FilterExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.html#eval"><span class="hs-identifier">eval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Eq.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Expr.Eq</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Eq</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Expr.Filter</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterType"><span class="hs-identifier">FilterType</span></a></span><span>
</span><span id="line-43"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterDate"><span class="hs-identifier">FilterDate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterDistance"><span class="hs-identifier">FilterDistance</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterDuration"><span class="hs-identifier">FilterDuration</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterLabel"><span class="hs-identifier">FilterLabel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterPace"><span class="hs-identifier">FilterPace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterType"><span class="hs-identifier">FilterType</span></a></span><span>
</span><span id="line-49"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Ord.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Expr.Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Ord.html#FilterOpOrd"><span class="hs-identifier">FilterOpOrd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Ord.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Expr.Ord</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ord</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Expr.Set</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Expr.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ESet</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Moment.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Time.Moment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Moment.html#Moment"><span class="hs-identifier">Moment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Moment.html#MomentTimestamp"><span class="hs-identifier">MomentTimestamp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Time.Timestamp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier">Timestamp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.html"><span class="hs-identifier">Pacer.Command.Chart.Data.Time.Timestamp</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TS</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Configuration.Env.Types.html"><span class="hs-identifier">Pacer.Configuration.Env.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Configuration.Env.Types.html#LogEnv"><span class="hs-identifier">LogEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Configuration.Env.Types.html#logLevel"><span class="hs-identifier">logLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Configuration.Env.Types.html#logVerbosity"><span class="hs-identifier">logVerbosity</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Configuration.Logging.html"><span class="hs-identifier">Pacer.Configuration.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Configuration.Logging.html#LogVerbosity"><span class="hs-identifier">LogVerbosity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Configuration.Logging.html#LogV1"><span class="hs-identifier">LogV1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.html"><span class="hs-identifier">Pacer.Data.Distance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Distance.html#Distance"><span class="hs-identifier">Distance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Distance.html#unDistance"><span class="hs-identifier">unDistance</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.html#SomeDistance"><span class="hs-identifier">SomeDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.html"><span class="hs-identifier">Pacer.Data.Distance</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Dist</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html"><span class="hs-identifier">Pacer.Data.Distance.Units</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#DistanceUnit"><span class="hs-identifier">DistanceUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Distance.Units.html#Kilometer"><span class="hs-identifier">Kilometer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#Meter"><span class="hs-identifier">Meter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#Mile"><span class="hs-identifier">Mile</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html"><span class="hs-identifier">Pacer.Data.Distance.Units</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DistU</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Data.Duration.html"><span class="hs-identifier">Pacer.Data.Duration</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Duration.html#Duration"><span class="hs-identifier">Duration</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Duration.html#unDuration"><span class="hs-identifier">unDuration</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Data.Pace.html"><span class="hs-identifier">Pacer.Data.Pace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Pace.html#SomePace"><span class="hs-identifier">SomePace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Pace.html#MkSomePace"><span class="hs-identifier">MkSomePace</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Exception.html"><span class="hs-identifier">Pacer.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Exception.html#CreateChartE"><span class="hs-identifier">CreateChartE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Exception.html#CreateChartFilterEmpty"><span class="hs-identifier">CreateChartFilterEmpty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Prelude.html"><span class="hs-identifier">Pacer.Prelude</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Utils.html"><span class="hs-identifier">Pacer.Utils</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">U</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><span class="hs-comment">-- | Holds chart data.</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">data</span><span> </span><span id="ChartData"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartData"><span class="hs-identifier hs-var">ChartData</span></a></span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ChartDataY"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartDataY"><span class="hs-identifier hs-var">ChartDataY</span></a></span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartY"><span class="hs-identifier hs-type">ChartY</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ChartDataY1"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartDataY1"><span class="hs-identifier hs-var">ChartDataY1</span></a></span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartY1"><span class="hs-identifier hs-type">ChartY1</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679727466"><span id="local-6989586621679727475"><span class="annot"><span class="annottext">ChartData -&gt; ChartData -&gt; Bool
(ChartData -&gt; ChartData -&gt; Bool)
-&gt; (ChartData -&gt; ChartData -&gt; Bool) -&gt; Eq ChartData
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ChartData -&gt; ChartData -&gt; Bool
== :: ChartData -&gt; ChartData -&gt; Bool
$c/= :: ChartData -&gt; ChartData -&gt; Bool
/= :: ChartData -&gt; ChartData -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679727480"><span id="local-6989586621679727489"><span id="local-6989586621679727493"><span class="annot"><span class="annottext">Int -&gt; ChartData -&gt; ShowS
[ChartData] -&gt; ShowS
ChartData -&gt; String
(Int -&gt; ChartData -&gt; ShowS)
-&gt; (ChartData -&gt; String)
-&gt; ([ChartData] -&gt; ShowS)
-&gt; Show ChartData
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ChartData -&gt; ShowS
showsPrec :: Int -&gt; ChartData -&gt; ShowS
$cshow :: ChartData -&gt; String
show :: ChartData -&gt; String
$cshowList :: [ChartData] -&gt; ShowS
showList :: [ChartData] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679727499"><span id="local-6989586621679727503"><span id="local-6989586621679727506"><span id="local-6989586621679727509"><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartData"><span class="hs-identifier hs-type">ChartData</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621679727516"><span class="annot"><span class="annottext">toJSON :: ChartData -&gt; Value
</span><a href="#local-6989586621679727516"><span class="hs-identifier hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartDataY"><span class="hs-identifier hs-type">ChartDataY</span></a></span><span> </span><span id="local-6989586621679727518"><span class="annot"><span class="annottext">ChartY
</span><a href="#local-6989586621679727518"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChartY -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ChartY
</span><a href="#local-6989586621679727518"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartDataY1"><span class="hs-identifier hs-type">ChartDataY1</span></a></span><span> </span><span id="local-6989586621679727519"><span class="annot"><span class="annottext">ChartY1
</span><a href="#local-6989586621679727519"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChartY1 -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ChartY1
</span><a href="#local-6989586621679727519"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><span class="hs-comment">-- | Data for a chart with a single Y axis.</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">data</span><span> </span><span id="ChartY"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartY"><span class="hs-identifier hs-var">ChartY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkChartY"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#MkChartY"><span class="hs-identifier hs-var">MkChartY</span></a></span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-comment">-- | X and Y axis data.</span></span><span>
</span><span id="line-85"></span><span>    </span><span id="values"><span class="annot"><span class="annottext">ChartY -&gt; NESeq (Timestamp, Double)
</span><a href="Pacer.Command.Chart.Data.ChartData.html#values"><span class="hs-identifier hs-var hs-var">values</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tuple2</span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">-- | Y axis type. This is used for the label on the line itself, __not__</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- the y-axis (that label is on ChartOptions).</span><span>
</span><span id="line-88"></span><span>    </span><span id="yType"><span class="annot"><span class="annottext">ChartY -&gt; YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartData.html#yType"><span class="hs-identifier hs-var hs-var">yType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisType"><span class="hs-identifier hs-type">YAxisType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Distance unit for y-axis, if it used.</span></span><span>
</span><span id="line-90"></span><span>    </span><span id="yDistUnit"><span class="annot"><span class="annottext">ChartY -&gt; DistanceUnit
</span><a href="Pacer.Command.Chart.Data.ChartData.html#yDistUnit"><span class="hs-identifier hs-var hs-var">yDistUnit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#DistanceUnit"><span class="hs-identifier hs-type">DistanceUnit</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679727525"><span id="local-6989586621679727534"><span class="annot"><span class="annottext">ChartY -&gt; ChartY -&gt; Bool
(ChartY -&gt; ChartY -&gt; Bool)
-&gt; (ChartY -&gt; ChartY -&gt; Bool) -&gt; Eq ChartY
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ChartY -&gt; ChartY -&gt; Bool
== :: ChartY -&gt; ChartY -&gt; Bool
$c/= :: ChartY -&gt; ChartY -&gt; Bool
/= :: ChartY -&gt; ChartY -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679727542"><span id="local-6989586621679727552"><span id="local-6989586621679727555"><span class="annot"><span class="annottext">Int -&gt; ChartY -&gt; ShowS
[ChartY] -&gt; ShowS
ChartY -&gt; String
(Int -&gt; ChartY -&gt; ShowS)
-&gt; (ChartY -&gt; String) -&gt; ([ChartY] -&gt; ShowS) -&gt; Show ChartY
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ChartY -&gt; ShowS
showsPrec :: Int -&gt; ChartY -&gt; ShowS
$cshow :: ChartY -&gt; String
show :: ChartY -&gt; String
$cshowList :: [ChartY] -&gt; ShowS
showList :: [ChartY] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679727564"><span id="local-6989586621679727567"><span id="local-6989586621679727570"><span id="local-6989586621679727573"><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartY"><span class="hs-identifier hs-type">ChartY</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679727593"><span class="annot"><span class="annottext">toJSON :: ChartY -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span id="local-6989586621679727594"><span class="annot"><span class="annottext">ChartY
</span><a href="#local-6989586621679727594"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">Asn.object</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;xAxis&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Timestamp] -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">[Timestamp]
</span><a href="#local-6989586621679727597"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;yAxes&quot;</span></span><span>
</span><span id="line-99"></span><span>          </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">Asn.object</span></a></span><span>
</span><span id="line-100"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;y&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679727598"><span class="hs-identifier hs-var">yAxis</span></a></span><span>
</span><span id="line-101"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679727597"><span class="annot"><span class="annottext">[Timestamp]
</span><a href="#local-6989586621679727597"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679727599"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679727599"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Timestamp, Double)] -&gt; ([Timestamp], [Double])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">L.unzip</span></span><span> </span><span class="annot"><span class="annottext">([(Timestamp, Double)] -&gt; ([Timestamp], [Double]))
-&gt; [(Timestamp, Double)] -&gt; ([Timestamp], [Double])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NESeq (Timestamp, Double) -&gt; [(Timestamp, Double)]
forall a. NESeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">ChartY
</span><a href="#local-6989586621679727594"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">values</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>      </span><span id="local-6989586621679727598"><span class="annot"><span class="annottext">yAxis :: Value
</span><a href="#local-6989586621679727598"><span class="hs-identifier hs-var hs-var">yAxis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DistanceUnit -&gt; [Double] -&gt; YAxisType -&gt; Text -&gt; Value
</span><a href="Pacer.Command.Chart.Data.ChartData.html#mkYJson"><span class="hs-identifier hs-var">mkYJson</span></a></span><span> </span><span class="annot"><span class="annottext">ChartY
</span><a href="#local-6989586621679727594"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">yDistUnit</span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679727599"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">ChartY
</span><a href="#local-6989586621679727594"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">yType</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;y&quot;</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- See NOTE: [Numeric Type]</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Data for a chart with two Y axes.</span></span><span>
</span><span id="line-111"></span><span class="hs-keyword">data</span><span> </span><span id="ChartY1"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartY1"><span class="hs-identifier hs-var">ChartY1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkChartY1"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#MkChartY1"><span class="hs-identifier hs-var">MkChartY1</span></a></span></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-comment">-- | Data for a chart with two y Axes.</span></span><span>
</span><span id="line-113"></span><span>    </span><span id="values"><span class="annot"><span class="annottext">ChartY1 -&gt; NESeq (Timestamp, Double, Double)
</span><a href="Pacer.Command.Chart.Data.ChartData.html#values"><span class="hs-identifier hs-var hs-var">values</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tuple3</span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Type of first Y axis.</span></span><span>
</span><span id="line-115"></span><span>    </span><span id="yType"><span class="annot"><span class="annottext">ChartY1 -&gt; YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartData.html#yType"><span class="hs-identifier hs-var hs-var">yType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisType"><span class="hs-identifier hs-type">YAxisType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Type of second Y axis.</span></span><span>
</span><span id="line-117"></span><span>    </span><span id="y1Type"><span class="annot"><span class="annottext">ChartY1 -&gt; YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartData.html#y1Type"><span class="hs-identifier hs-var hs-var">y1Type</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisType"><span class="hs-identifier hs-type">YAxisType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Distance unit for y-axis, if it used.</span></span><span>
</span><span id="line-119"></span><span>    </span><span id="yDistUnit"><span class="annot"><span class="annottext">ChartY1 -&gt; DistanceUnit
</span><a href="Pacer.Command.Chart.Data.ChartData.html#yDistUnit"><span class="hs-identifier hs-var hs-var">yDistUnit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#DistanceUnit"><span class="hs-identifier hs-type">DistanceUnit</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679727609"><span id="local-6989586621679727616"><span class="annot"><span class="annottext">ChartY1 -&gt; ChartY1 -&gt; Bool
(ChartY1 -&gt; ChartY1 -&gt; Bool)
-&gt; (ChartY1 -&gt; ChartY1 -&gt; Bool) -&gt; Eq ChartY1
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ChartY1 -&gt; ChartY1 -&gt; Bool
== :: ChartY1 -&gt; ChartY1 -&gt; Bool
$c/= :: ChartY1 -&gt; ChartY1 -&gt; Bool
/= :: ChartY1 -&gt; ChartY1 -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679727623"><span id="local-6989586621679727631"><span id="local-6989586621679727634"><span class="annot"><span class="annottext">Int -&gt; ChartY1 -&gt; ShowS
[ChartY1] -&gt; ShowS
ChartY1 -&gt; String
(Int -&gt; ChartY1 -&gt; ShowS)
-&gt; (ChartY1 -&gt; String) -&gt; ([ChartY1] -&gt; ShowS) -&gt; Show ChartY1
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ChartY1 -&gt; ShowS
showsPrec :: Int -&gt; ChartY1 -&gt; ShowS
$cshow :: ChartY1 -&gt; String
show :: ChartY1 -&gt; String
$cshowList :: [ChartY1] -&gt; ShowS
showList :: [ChartY1] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679727642"><span id="local-6989586621679727645"><span id="local-6989586621679727648"><span id="local-6989586621679727651"><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartY1"><span class="hs-identifier hs-type">ChartY1</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679727674"><span class="annot"><span class="annottext">toJSON :: ChartY1 -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span id="local-6989586621679727675"><span class="annot"><span class="annottext">ChartY1
</span><a href="#local-6989586621679727675"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">Asn.object</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;xAxis&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Timestamp] -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">[Timestamp]
</span><a href="#local-6989586621679727676"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;yAxes&quot;</span></span><span>
</span><span id="line-128"></span><span>          </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">Asn.object</span></a></span><span>
</span><span id="line-129"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;y&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679727677"><span class="hs-identifier hs-var">yAxis</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>              </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;y1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679727678"><span class="hs-identifier hs-var">y1Axis</span></a></span><span>
</span><span id="line-131"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679727676"><span class="annot"><span class="annottext">[Timestamp]
</span><a href="#local-6989586621679727676"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679727679"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679727679"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679727680"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679727680"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Timestamp, Double, Double)] -&gt; ([Timestamp], [Double], [Double])
forall a b c. [(a, b, c)] -&gt; ([a], [b], [c])
</span><span class="hs-identifier hs-var">L.unzip3</span></span><span> </span><span class="annot"><span class="annottext">([(Timestamp, Double, Double)]
 -&gt; ([Timestamp], [Double], [Double]))
-&gt; [(Timestamp, Double, Double)]
-&gt; ([Timestamp], [Double], [Double])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NESeq (Timestamp, Double, Double) -&gt; [(Timestamp, Double, Double)]
forall a. NESeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">ChartY1
</span><a href="#local-6989586621679727675"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">values</span><span>
</span><span id="line-135"></span><span>      </span><span id="local-6989586621679727677"><span class="annot"><span class="annottext">yAxis :: Value
</span><a href="#local-6989586621679727677"><span class="hs-identifier hs-var hs-var">yAxis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DistanceUnit -&gt; [Double] -&gt; YAxisType -&gt; Text -&gt; Value
</span><a href="Pacer.Command.Chart.Data.ChartData.html#mkYJson"><span class="hs-identifier hs-var">mkYJson</span></a></span><span> </span><span class="annot"><span class="annottext">ChartY1
</span><a href="#local-6989586621679727675"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">yDistUnit</span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679727679"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">ChartY1
</span><a href="#local-6989586621679727675"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">yType</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;y&quot;</span></span><span>
</span><span id="line-136"></span><span>      </span><span id="local-6989586621679727678"><span class="annot"><span class="annottext">y1Axis :: Value
</span><a href="#local-6989586621679727678"><span class="hs-identifier hs-var hs-var">y1Axis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DistanceUnit -&gt; [Double] -&gt; YAxisType -&gt; Text -&gt; Value
</span><a href="Pacer.Command.Chart.Data.ChartData.html#mkYJson"><span class="hs-identifier hs-var">mkYJson</span></a></span><span> </span><span class="annot"><span class="annottext">ChartY1
</span><a href="#local-6989586621679727675"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">yDistUnit</span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679727680"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">ChartY1
</span><a href="#local-6989586621679727675"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">y1Type</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;y1&quot;</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#mkYJson"><span class="hs-identifier hs-type">mkYJson</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#DistanceUnit"><span class="hs-identifier hs-type">DistanceUnit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisType"><span class="hs-identifier hs-type">YAxisType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-139"></span><span id="mkYJson"><span class="annot"><span class="annottext">mkYJson :: DistanceUnit -&gt; [Double] -&gt; YAxisType -&gt; Text -&gt; Value
</span><a href="Pacer.Command.Chart.Data.ChartData.html#mkYJson"><span class="hs-identifier hs-var hs-var">mkYJson</span></a></span></span><span> </span><span id="local-6989586621679727682"><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727682"><span class="hs-identifier hs-var">dunit</span></a></span></span><span> </span><span id="local-6989586621679727683"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679727683"><span class="hs-identifier hs-var">yVal</span></a></span></span><span> </span><span id="local-6989586621679727684"><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727684"><span class="hs-identifier hs-var">yType</span></a></span></span><span> </span><span id="local-6989586621679727685"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679727685"><span class="hs-identifier hs-var">yId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">Asn.object</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;data&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Double] -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679727683"><span class="hs-identifier hs-var">yVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;label&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">YAxisType -&gt; Text
</span><a href="#local-6989586621679727686"><span class="hs-identifier hs-var">mkYLabel</span></a></span><span> </span><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727684"><span class="hs-identifier hs-var">yType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- m, km, mi</span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; YAxisType -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727684"><span class="hs-identifier hs-var">yType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- distance, duration, pace</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;id&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679727685"><span class="hs-identifier hs-var">yId</span></a></span><span> </span><span class="hs-comment">-- y, y1</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="#local-6989586621679727686"><span class="hs-identifier hs-type">mkYLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisType"><span class="hs-identifier hs-type">YAxisType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679727686"><span class="annot"><span class="annottext">mkYLabel :: YAxisType -&gt; Text
</span><a href="#local-6989586621679727686"><span class="hs-identifier hs-var hs-var">mkYLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><span class="annottext">YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisDistance"><span class="hs-identifier hs-var">YAxisDistance</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679727687"><span class="hs-identifier hs-var">dstTxt</span></a></span><span>
</span><span id="line-150"></span><span>      </span><span class="annot"><span class="annottext">YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisDuration"><span class="hs-identifier hs-var">YAxisDuration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;time&quot;</span></span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><span class="annottext">YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisPace"><span class="hs-identifier hs-var">YAxisPace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;pace /&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679727687"><span class="hs-identifier hs-var">dstTxt</span></a></span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>        </span><span id="local-6989586621679727687"><span class="annot"><span class="annottext">dstTxt :: Text
</span><a href="#local-6989586621679727687"><span class="hs-identifier hs-var hs-var">dstTxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DistanceUnit -&gt; Text
forall a. Display a =&gt; a -&gt; Text
</span><a href="file:///nix/store/v4mdbmfdmg0vckv8d11a05a84s63a9v9-text-display-1.0.0.0-doc/share/doc/text-display-1.0.0.0/html/src/Data.Text.Display.Core.html/Data.Text.Display.Core.html#display"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727682"><span class="hs-identifier hs-var">dunit</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- | Accumulator for chart with a single Y axis.</span></span><span>
</span><span id="line-156"></span><span class="hs-keyword">type</span><span> </span><span id="AccY"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#AccY"><span class="hs-identifier hs-var">AccY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tuple2</span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><span class="hs-comment">-- | Accumulator for chart with two Y axes.</span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">type</span><span> </span><span id="AccY1"><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#AccY1"><span class="hs-identifier hs-var">AccY1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tuple3</span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- NOTE: HLint incorrectly thinks some brackets are unnecessary.</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- See NOTE: [Brackets with OverloadedRecordDot].</span><span>
</span><span id="line-163"></span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span class="hs-comment">{- HLINT ignore &quot;Redundant bracket&quot; -}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><span class="hs-comment">-- | Turns a sequence of activities and a chart request into a chart.</span></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#mkChartData"><span class="hs-identifier hs-type">mkChartData</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679727193"><span class="annot"><a href="#local-6989586621679727193"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span id="local-6989586621679727189"><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/v4mdbmfdmg0vckv8d11a05a84s63a9v9-text-display-1.0.0.0-doc/share/doc/text-display-1.0.0.0/html/src/Data.Text.Display.Core.html/Data.Text.Display.Core.html#Display"><span class="hs-identifier hs-type">Display</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Integer.html/Numeric.Convert.Integer.html#From%2124"><span class="hs-identifier hs-type">From&#8484;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Algebra.MetricSpace.html/Numeric.Algebra.MetricSpace.html#MetricSpace"><span class="hs-identifier hs-type">MetricSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/logger-effectful-0.1-4c462c8d83799fc5c4900b79f30134a510b541d670854fe1dc3097beacce1d6c/share/doc/html/src/Effectful.Logger.Dynamic.html/Effectful.Logger.Dynamic.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Effect.html/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727193"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Reader.Static.html/Effectful.Reader.Static.html#Reader"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Pacer.Configuration.Env.Types.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Effect.html/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727193"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Algebra.Semifield.html/Numeric.Algebra.Semifield.html#Semifield"><span class="hs-identifier hs-type">Semifield</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Real.html/Numeric.Convert.Real.html#To%211D"><span class="hs-identifier hs-type">To&#8477;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Final distance unit to use.</span></span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#DistanceUnit"><span class="hs-identifier hs-type">DistanceUnit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Global filters</span></span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.html#FilterExpr"><span class="hs-identifier hs-type">FilterExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="hs-comment">-- | List of activities.</span></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivities"><span class="hs-identifier hs-type">SomeActivities</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Chart request.</span></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartRequest"><span class="hs-identifier hs-type">ChartRequest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727189"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="hs-comment">-- | ChartData result. Nothing if no activities passed the request's filter.</span></span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Monad.html/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727193"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Result.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="annot"><a href="Pacer.Exception.html#CreateChartE"><span class="hs-identifier hs-type">CreateChartE</span></a></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartData"><span class="hs-identifier hs-type">ChartData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span id="mkChartData"><span class="annot"><span class="annottext">mkChartData :: forall (es :: [Effect]) a.
(Display a, From&#8484; a, MetricSpace a, Logger :&gt; es, Ord a,
 Reader LogEnv :&gt; es, Semifield a, Show a, To&#8477; a) =&gt;
DistanceUnit
-&gt; [FilterExpr a]
-&gt; SomeActivities a
-&gt; ChartRequest a
-&gt; Eff es (Result CreateChartE ChartData)
</span><a href="Pacer.Command.Chart.Data.ChartData.html#mkChartData"><span class="hs-identifier hs-var hs-var">mkChartData</span></a></span></span><span> </span><span id="local-6989586621679727727"><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727727"><span class="hs-identifier hs-var">finalDistUnit</span></a></span></span><span> </span><span id="local-6989586621679727728"><span class="annot"><span class="annottext">[FilterExpr a]
</span><a href="#local-6989586621679727728"><span class="hs-identifier hs-var">globalFilters</span></a></span></span><span> </span><span id="local-6989586621679727729"><span class="annot"><span class="annottext">SomeActivities a
</span><a href="#local-6989586621679727729"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679727730"><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727730"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq (SomeActivity a)
</span><a href="#local-6989586621679727731"><span class="hs-identifier hs-var">filteredActivities</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">Seq (SomeActivity a)
</span><span class="hs-identifier hs-var">Empty</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result CreateChartE ChartData
-&gt; Eff es (Result CreateChartE ChartData)
forall a. a -&gt; Eff es a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Result CreateChartE ChartData
 -&gt; Eff es (Result CreateChartE ChartData))
-&gt; Result CreateChartE ChartData
-&gt; Eff es (Result CreateChartE ChartData)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CreateChartE -&gt; Result CreateChartE ChartData
forall e a. e -&gt; Result e a
</span><a href="Pacer.Data.Result.html#Err"><span class="hs-identifier hs-var">Err</span></a></span><span> </span><span class="annot"><span class="annottext">(CreateChartE -&gt; Result CreateChartE ChartData)
-&gt; CreateChartE -&gt; Result CreateChartE ChartData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; CreateChartE
</span><a href="Pacer.Exception.html#CreateChartFilterEmpty"><span class="hs-identifier hs-var">CreateChartFilterEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727730"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">title</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679727733"><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727733"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span> </span><span id="local-6989586621679727735"><span class="annot"><span class="annottext">Seq (SomeActivity a)
</span><a href="#local-6989586621679727735"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>      </span><span id="local-6989586621679727736"><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727736"><span class="hs-identifier hs-var">activities</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ChartType
-&gt; NESeq (SomeActivity a) -&gt; Eff es (NESeq (SomeActivity a))
forall (es :: [Effect]) a.
(Display a, From&#8484; a, Logger :&gt; es, Ord a, Reader LogEnv :&gt; es,
 Semifield a, Show a, To&#8477; a) =&gt;
Maybe ChartType
-&gt; NESeq (SomeActivity a) -&gt; Eff es (NESeq (SomeActivity a))
</span><a href="Pacer.Command.Chart.Data.ChartData.html#handleChartType"><span class="hs-identifier hs-var">handleChartType</span></a></span><span> </span><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727730"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">chartType</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727733"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; Seq (SomeActivity a) -&gt; NESeq (SomeActivity a)
forall a. a -&gt; Seq a -&gt; NESeq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-var">:&lt;||</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (SomeActivity a)
</span><a href="#local-6989586621679727735"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">ChartData -&gt; Result CreateChartE ChartData
forall e a. a -&gt; Result e a
</span><a href="Pacer.Data.Result.html#Ok"><span class="hs-identifier hs-var">Ok</span></a></span><span> </span><span class="annot"><span class="annottext">(ChartData -&gt; Result CreateChartE ChartData)
-&gt; ChartData -&gt; Result CreateChartE ChartData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DistanceUnit
-&gt; ChartRequest a -&gt; NESeq (SomeActivity a) -&gt; ChartData
forall a.
(From&#8484; a, Ord a, Semifield a, Show a, To&#8477; a) =&gt;
DistanceUnit
-&gt; ChartRequest a -&gt; NESeq (SomeActivity a) -&gt; ChartData
</span><a href="Pacer.Command.Chart.Data.ChartData.html#mkChartDataSets"><span class="hs-identifier hs-var">mkChartDataSets</span></a></span><span> </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727727"><span class="hs-identifier hs-var">finalDistUnit</span></a></span><span> </span><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727730"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727736"><span class="hs-identifier hs-var">activities</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivities"><span class="hs-identifier hs-type">MkSomeActivities</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Prelude.html#SetToSeqNE"><span class="hs-identifier hs-type">SetToSeqNE</span></a></span><span> </span><span id="local-6989586621679727742"><span class="annot"><span class="annottext">NESeq (SomeActivitiesKey a)
</span><a href="#local-6989586621679727742"><span class="hs-identifier hs-var">someActivities</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeActivities a
</span><a href="#local-6989586621679727729"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679727731"><span class="annot"><span class="annottext">filteredActivities :: Seq (SomeActivity a)
</span><a href="#local-6989586621679727731"><span class="hs-identifier hs-var hs-var">filteredActivities</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><span class="annottext">NESeq (SomeActivitiesKey a)
-&gt; [FilterExpr a] -&gt; Seq (SomeActivity a)
forall a.
(From&#8484; a, MetricSpace a, Ord a, Semifield a, Show a) =&gt;
NESeq (SomeActivitiesKey a)
-&gt; [FilterExpr a] -&gt; Seq (SomeActivity a)
</span><a href="Pacer.Command.Chart.Data.ChartData.html#filterActivities"><span class="hs-identifier hs-var">filterActivities</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">NESeq (SomeActivitiesKey a)
</span><a href="#local-6989586621679727742"><span class="hs-identifier hs-var">someActivities</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilterExpr a]
</span><a href="#local-6989586621679727728"><span class="hs-identifier hs-var">globalFilters</span></a></span><span> </span><span class="annot"><span class="annottext">[FilterExpr a] -&gt; [FilterExpr a] -&gt; [FilterExpr a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727730"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">filters</span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><span class="hs-comment">-- | Transforms the activities based on the chart type.</span></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#handleChartType"><span class="hs-identifier hs-type">handleChartType</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679727222"><span class="annot"><a href="#local-6989586621679727222"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span id="local-6989586621679727221"><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/v4mdbmfdmg0vckv8d11a05a84s63a9v9-text-display-1.0.0.0-doc/share/doc/text-display-1.0.0.0/html/src/Data.Text.Display.Core.html/Data.Text.Display.Core.html#Display"><span class="hs-identifier hs-type">Display</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Integer.html/Numeric.Convert.Integer.html#From%2124"><span class="hs-identifier hs-type">From&#8484;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/logger-effectful-0.1-4c462c8d83799fc5c4900b79f30134a510b541d670854fe1dc3097beacce1d6c/share/doc/html/src/Effectful.Logger.Dynamic.html/Effectful.Logger.Dynamic.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Effect.html/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727222"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Reader.Static.html/Effectful.Reader.Static.html#Reader"><span class="hs-identifier hs-type">Reader</span></a></span><span> </span><span class="annot"><a href="Pacer.Configuration.Env.Types.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Effect.html/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727222"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Algebra.Semifield.html/Numeric.Algebra.Semifield.html#Semifield"><span class="hs-identifier hs-type">Semifield</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Real.html/Numeric.Convert.Real.html#To%211D"><span class="hs-identifier hs-type">To&#8477;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartType"><span class="hs-identifier hs-type">ChartType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Monad.html/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727222"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span id="handleChartType"><span class="annot"><span class="annottext">handleChartType :: forall (es :: [Effect]) a.
(Display a, From&#8484; a, Logger :&gt; es, Ord a, Reader LogEnv :&gt; es,
 Semifield a, Show a, To&#8477; a) =&gt;
Maybe ChartType
-&gt; NESeq (SomeActivity a) -&gt; Eff es (NESeq (SomeActivity a))
</span><a href="Pacer.Command.Chart.Data.ChartData.html#handleChartType"><span class="hs-identifier hs-var hs-var">handleChartType</span></a></span></span><span> </span><span class="hs-glyph">@</span><span id="local-6989586621679727800"><span class="annot"><a href="#local-6989586621679727800"><span class="hs-identifier hs-type hs-type">es</span></a></span></span><span> </span><span class="hs-glyph">@</span><span id="local-6989586621679727801"><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679727802"><span class="annot"><span class="annottext">Maybe ChartType
</span><a href="#local-6989586621679727802"><span class="hs-identifier hs-var">mChartType</span></a></span></span><span> </span><span id="local-6989586621679727803"><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727803"><span class="hs-identifier hs-var">someActivities</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ChartType
</span><a href="#local-6989586621679727802"><span class="hs-identifier hs-var">mChartType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="annottext">Maybe ChartType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a) -&gt; Eff es (NESeq (SomeActivity a))
forall a. a -&gt; Eff es a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727803"><span class="hs-identifier hs-var">someActivities</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ChartType
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartTypeDefault"><span class="hs-identifier hs-var">ChartTypeDefault</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a) -&gt; Eff es (NESeq (SomeActivity a))
forall a. a -&gt; Eff es a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727803"><span class="hs-identifier hs-var">someActivities</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartTypeSum"><span class="hs-identifier hs-type">ChartTypeSum</span></a></span><span> </span><span id="local-6989586621679727804"><span class="annot"><span class="annottext">ChartSumPeriod
</span><a href="#local-6989586621679727804"><span class="hs-identifier hs-var">period</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Day -&gt; ChartSumPeriod -&gt; Eff es (NESeq (SomeActivity a))
</span><a href="#local-6989586621679727805"><span class="hs-identifier hs-var">sumPeriod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NESeq (SomeActivity a) -&gt; Day
</span><a href="#local-6989586621679727806"><span class="hs-identifier hs-var">getStartDay</span></a></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727803"><span class="hs-identifier hs-var">someActivities</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ChartSumPeriod
</span><a href="#local-6989586621679727804"><span class="hs-identifier hs-var">period</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="#local-6989586621679727806"><span class="hs-identifier hs-type">getStartDay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span>
</span><span id="line-223"></span><span>    </span><span id="local-6989586621679727806"><span class="annot"><span class="annottext">getStartDay :: NESeq (SomeActivity a) -&gt; Day
</span><a href="#local-6989586621679727806"><span class="hs-identifier hs-var hs-var">getStartDay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><span class="annottext">Timestamp -&gt; Day
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#timestampToDay"><span class="hs-identifier hs-var">TS.timestampToDay</span></a></span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">(Timestamp -&gt; Day)
-&gt; (NESeq (SomeActivity a) -&gt; Timestamp)
-&gt; NESeq (SomeActivity a)
-&gt; Day
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(forall (d :: DistanceUnit). Activity d a -&gt; Timestamp)
-&gt; SomeActivity a -&gt; Timestamp
forall a b.
(forall (d :: DistanceUnit). Activity d a -&gt; b)
-&gt; SomeActivity a -&gt; b
</span><a href="Pacer.Command.Chart.Data.Activity.html#someActivityApplyActivity"><span class="hs-identifier hs-var">Activity.someActivityApplyActivity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">datetime</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="annottext">(SomeActivity a -&gt; Timestamp)
-&gt; (NESeq (SomeActivity a) -&gt; SomeActivity a)
-&gt; NESeq (SomeActivity a)
-&gt; Timestamp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a) -&gt; SomeActivity a
forall a. NESeq a -&gt; a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.html/Data.Sequence.NonEmpty.html#head"><span class="hs-identifier hs-var">NESeq.head</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-comment">-- groupBy on Mapping to period</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="#local-6989586621679727805"><span class="hs-identifier hs-type">sumPeriod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumPeriod"><span class="hs-identifier hs-type">ChartSumPeriod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Monad.html/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727800"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679727805"><span class="annot"><span class="annottext">sumPeriod :: Day -&gt; ChartSumPeriod -&gt; Eff es (NESeq (SomeActivity a))
</span><a href="#local-6989586621679727805"><span class="hs-identifier hs-var hs-var">sumPeriod</span></a></span></span><span> </span><span id="local-6989586621679727812"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679727812"><span class="hs-identifier hs-var">startDay</span></a></span></span><span> </span><span id="local-6989586621679727813"><span class="annot"><span class="annottext">ChartSumPeriod
</span><a href="#local-6989586621679727813"><span class="hs-identifier hs-var">period</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NESeq (NESeq (SomeActivity a)) -&gt; NESeq (SomeActivity a))
-&gt; Eff es (NESeq (NESeq (SomeActivity a)))
-&gt; Eff es (NESeq (SomeActivity a))
forall a b. (a -&gt; b) -&gt; Eff es a -&gt; Eff es b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((NESeq (NESeq (SomeActivity a)) -&gt; NESeq (SomeActivity a))
 -&gt; Eff es (NESeq (NESeq (SomeActivity a)))
 -&gt; Eff es (NESeq (SomeActivity a)))
-&gt; ((NESeq (SomeActivity a) -&gt; SomeActivity a)
    -&gt; NESeq (NESeq (SomeActivity a)) -&gt; NESeq (SomeActivity a))
-&gt; (NESeq (SomeActivity a) -&gt; SomeActivity a)
-&gt; Eff es (NESeq (NESeq (SomeActivity a)))
-&gt; Eff es (NESeq (SomeActivity a))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NESeq (SomeActivity a) -&gt; SomeActivity a)
-&gt; NESeq (NESeq (SomeActivity a)) -&gt; NESeq (SomeActivity a)
forall a b. (a -&gt; b) -&gt; NESeq a -&gt; NESeq b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a) -&gt; SomeActivity a
</span><a href="#local-6989586621679727814"><span class="hs-identifier hs-var">sumActivities</span></a></span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="annottext">(Eff es (NESeq (NESeq (SomeActivity a)))
 -&gt; Eff es (NESeq (SomeActivity a)))
-&gt; (NESeq (SomeActivity a)
    -&gt; Eff es (NESeq (NESeq (SomeActivity a))))
-&gt; NESeq (SomeActivity a)
-&gt; Eff es (NESeq (SomeActivity a))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a) -&gt; Eff es (NESeq (NESeq (SomeActivity a)))
</span><a href="#local-6989586621679727815"><span class="hs-identifier hs-var">groupByPeriod</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="annottext">(NESeq (SomeActivity a) -&gt; Eff es (NESeq (SomeActivity a)))
-&gt; NESeq (SomeActivity a) -&gt; Eff es (NESeq (SomeActivity a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727803"><span class="hs-identifier hs-var">someActivities</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><a href="#local-6989586621679727816"><span class="hs-identifier hs-type">compPeriod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><a href="#local-6989586621679727817"><span class="hs-identifier hs-type">roundFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-comment">-- The idea here is:</span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-comment">-- 1. We group the activities via the compPeriod function i.e. determine</span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-comment">--    if they belong in the same time interval.</span><span>
</span><span id="line-242"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-comment">-- 2. Round the first element in the group down to the interval</span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-comment">--    start (e.g. calendary week, arbitrary start day), then sum</span><span>
</span><span id="line-245"></span><span>        </span><span class="hs-comment">--    up everything in that group as one event.</span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679727816"><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp -&gt; Bool
</span><a href="#local-6989586621679727816"><span class="hs-identifier hs-var">compPeriod</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679727817"><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp
</span><a href="#local-6989586621679727817"><span class="hs-identifier hs-var">roundFn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChartSumPeriod
</span><a href="#local-6989586621679727813"><span class="hs-identifier hs-var">period</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-247"></span><span>          </span><span class="annot"><span class="annottext">ChartSumPeriod
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumWeek"><span class="hs-identifier hs-var">ChartSumWeek</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.html#sameWeek"><span class="hs-identifier hs-var">TS.sameWeek</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.html#roundTimestampWeek"><span class="hs-identifier hs-var">TS.roundTimestampWeek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>          </span><span class="annot"><span class="annottext">ChartSumPeriod
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumMonth"><span class="hs-identifier hs-var">ChartSumMonth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Timestamp -&gt; Timestamp -&gt; Bool
Timestamp -&gt; Timestamp -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.html#sameMonth"><span class="hs-identifier hs-var">TS.sameMonth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.html#roundTimestampMonth"><span class="hs-identifier hs-var">TS.roundTimestampMonth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>          </span><span class="annot"><span class="annottext">ChartSumPeriod
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumYear"><span class="hs-identifier hs-var">ChartSumYear</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Timestamp -&gt; Timestamp -&gt; Bool
Timestamp -&gt; Timestamp -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.html#sameYear"><span class="hs-identifier hs-var">TS.sameYear</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.html#roundTimestampYear"><span class="hs-identifier hs-var">TS.roundTimestampYear</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>          </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartSumDays"><span class="hs-identifier hs-type">ChartSumDays</span></a></span><span> </span><span id="local-6989586621679727824"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679727824"><span class="hs-identifier hs-var">days</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-251"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Word16 -&gt; Timestamp -&gt; Timestamp -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.html#sameInterval"><span class="hs-identifier hs-var">TS.sameInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679727812"><span class="hs-identifier hs-var">startDay</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679727824"><span class="hs-identifier hs-var">days</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Day -&gt; Word16 -&gt; Timestamp -&gt; Timestamp
</span><a href="Pacer.Command.Chart.Data.Time.Timestamp.html#roundInterval"><span class="hs-identifier hs-var">TS.roundInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679727812"><span class="hs-identifier hs-var">startDay</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679727824"><span class="hs-identifier hs-var">days</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><a href="#local-6989586621679727814"><span class="hs-identifier hs-type">sumActivities</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-254"></span><span>        </span><span id="local-6989586621679727814"><span class="annot"><span class="annottext">sumActivities :: NESeq (SomeActivity a) -&gt; SomeActivity a
</span><a href="#local-6989586621679727814"><span class="hs-identifier hs-var hs-var">sumActivities</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span id="local-6989586621679727836"><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727836"><span class="hs-identifier hs-var">sy</span></a></span></span><span> </span><span id="local-6989586621679727837"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727837"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-type">:&lt;||</span></a></span><span> </span><span id="local-6989586621679727838"><span class="annot"><span class="annottext">Seq (SomeActivity a)
</span><a href="#local-6989586621679727838"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeActivity a -&gt; SomeActivity a -&gt; SomeActivity a)
-&gt; NESeq (SomeActivity a) -&gt; SomeActivity a
forall (t :: * -&gt; *) a. Foldable1 t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1'</span></span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; SomeActivity a -&gt; SomeActivity a
</span><a href="#local-6989586621679727839"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727840"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; Seq (SomeActivity a) -&gt; NESeq (SomeActivity a)
forall a. a -&gt; Seq a -&gt; NESeq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-var">:&lt;||</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (SomeActivity a)
</span><a href="#local-6989586621679727838"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><a href="#local-6989586621679727839"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-257"></span><span>            </span><span id="local-6989586621679727839"><span class="annot"><span class="annottext">go :: SomeActivity a -&gt; SomeActivity a -&gt; SomeActivity a
</span><a href="#local-6989586621679727839"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span id="local-6989586621679727841"><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727841"><span class="hs-identifier hs-var">sacc</span></a></span></span><span> </span><span id="local-6989586621679727842"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727842"><span class="hs-identifier hs-var">acc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span id="local-6989586621679727851"><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727851"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679727852"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727852"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>              </span><span class="annot"><span class="annottext">Sing d -&gt; Activity d a -&gt; SomeActivity a
forall (d :: DistanceUnit) a.
Sing d -&gt; Activity d a -&gt; SomeActivity a
</span><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-var">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727841"><span class="hs-identifier hs-var">sacc</span></a></span><span>
</span><span id="line-259"></span><span>                </span><span class="annot"><span class="annottext">(Activity d a -&gt; SomeActivity a) -&gt; Activity d a -&gt; SomeActivity a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkActivity"><span class="hs-identifier hs-type">MkActivity</span></a></span><span>
</span><span id="line-260"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">atype :: Maybe ActivityType
</span><a href="Pacer.Command.Chart.Data.Activity.html#atype"><span class="hs-identifier hs-var">atype</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727842"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">atype</span><span class="hs-special">,</span><span>
</span><span id="line-261"></span><span>                    </span><span class="hs-comment">-- Only need to add distance and time, since everything</span><span>
</span><span id="line-262"></span><span>                    </span><span class="hs-comment">-- else is set in the initial value (init).</span><span>
</span><span id="line-263"></span><span>                    </span><span class="annot"><span class="annottext">datetime :: Timestamp
</span><a href="Pacer.Command.Chart.Data.Activity.html#datetime"><span class="hs-identifier hs-var">datetime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727842"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">datetime</span><span class="hs-special">,</span><span>
</span><span id="line-264"></span><span>                    </span><span class="annot"><span class="annottext">distance :: Distance d a
</span><a href="Pacer.Command.Chart.Data.Activity.html#distance"><span class="hs-identifier hs-var">distance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Distance d a
</span><a href="#local-6989586621679727854"><span class="hs-identifier hs-var">newDist</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-265"></span><span>                    </span><span class="annot"><span class="annottext">duration :: Duration a
</span><a href="Pacer.Command.Chart.Data.Activity.html#duration"><span class="hs-identifier hs-var">duration</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727842"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">duration</span><span> </span><span class="annot"><span class="annottext">Duration a -&gt; Duration a -&gt; Duration a
forall s. ASemigroup s =&gt; s -&gt; s -&gt; s
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Algebra.Additive.ASemigroup.html/Numeric.Algebra.Additive.ASemigroup.html#.%2B."><span class="hs-operator hs-var">.+.</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727852"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">duration</span><span class="hs-special">,</span><span>
</span><span id="line-266"></span><span>                    </span><span class="annot"><span class="annottext">labels :: Set Label
</span><a href="Pacer.Command.Chart.Data.Activity.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727842"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">labels</span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>                    </span><span class="annot"><span class="annottext">title :: Maybe Text
</span><a href="Pacer.Command.Chart.Data.Activity.html#title"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727842"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">title</span><span>
</span><span id="line-268"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-269"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>                </span><span id="local-6989586621679727854"><span class="annot"><span class="annottext">newDist :: Distance d a
</span><a href="#local-6989586621679727854"><span class="hs-identifier hs-var hs-var">newDist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>                  </span><span class="annot"><span class="annottext">Sing d -&gt; (SingI d =&gt; Distance d a) -&gt; Distance d a
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727841"><span class="hs-identifier hs-var">sacc</span></a></span><span>
</span><span id="line-272"></span><span>                    </span><span class="annot"><span class="annottext">((SingI d =&gt; Distance d a) -&gt; Distance d a)
-&gt; (SingI d =&gt; Distance d a) -&gt; Distance d a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sing d -&gt; (SingI d =&gt; Distance d a) -&gt; Distance d a
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727851"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-273"></span><span>                    </span><span class="annot"><span class="annottext">((SingI d =&gt; Distance d a) -&gt; Distance d a)
-&gt; (SingI d =&gt; Distance d a) -&gt; Distance d a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall (d :: DistanceUnit).
 Distance d a -&gt; Distance d a -&gt; Distance d a)
-&gt; Distance d a -&gt; Distance d a -&gt; Distance d a
forall (d1 :: DistanceUnit) (d2 :: DistanceUnit) a.
(From&#8484; a, Ord a, Semifield a, Show a, SingI d1, SingI d2) =&gt;
(forall (d :: DistanceUnit).
 Distance d a -&gt; Distance d a -&gt; Distance d a)
-&gt; Distance d1 a -&gt; Distance d2 a -&gt; Distance d1 a
</span><a href="Pacer.Data.Distance.html#liftDistLeft2"><span class="hs-identifier hs-var">Dist.liftDistLeft2</span></a></span><span>
</span><span id="line-274"></span><span>                      </span><span class="annot"><span class="annottext">Distance d a -&gt; Distance d a -&gt; Distance d a
forall s. ASemigroup s =&gt; s -&gt; s -&gt; s
forall (d :: DistanceUnit).
Distance d a -&gt; Distance d a -&gt; Distance d a
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Algebra.Additive.ASemigroup.html/Numeric.Algebra.Additive.ASemigroup.html#.%2B."><span class="hs-operator hs-var">(.+.)</span></a></span><span>
</span><span id="line-275"></span><span>                      </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727842"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">distance</span><span>
</span><span id="line-276"></span><span>                      </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727852"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">distance</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>            </span><span id="local-6989586621679727840"><span class="annot"><span class="annottext">init :: SomeActivity a
</span><a href="#local-6989586621679727840"><span class="hs-identifier hs-var hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>              </span><span class="annot"><span class="annottext">Sing d -&gt; Activity d a -&gt; SomeActivity a
forall (d :: DistanceUnit) a.
Sing d -&gt; Activity d a -&gt; SomeActivity a
</span><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-var">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727836"><span class="hs-identifier hs-var">sy</span></a></span><span>
</span><span id="line-280"></span><span>                </span><span class="annot"><span class="annottext">(Activity d a -&gt; SomeActivity a) -&gt; Activity d a -&gt; SomeActivity a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkActivity"><span class="hs-identifier hs-type">MkActivity</span></a></span><span>
</span><span id="line-281"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- REVIEW: Should this be Nothing? Or something else e.g.</span><span>
</span><span id="line-282"></span><span>                    </span><span class="hs-comment">-- first element, &quot;Sum&quot;, or maybe logic to see if all</span><span>
</span><span id="line-283"></span><span>                    </span><span class="hs-comment">-- all elements have the same type?</span><span>
</span><span id="line-284"></span><span>                    </span><span class="annot"><span class="annottext">atype :: Maybe ActivityType
</span><a href="Pacer.Command.Chart.Data.Activity.html#atype"><span class="hs-identifier hs-var">atype</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ActivityType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-285"></span><span>                    </span><span class="annot"><span class="annottext">datetime :: Timestamp
</span><a href="Pacer.Command.Chart.Data.Activity.html#datetime"><span class="hs-identifier hs-var">datetime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp
</span><a href="#local-6989586621679727817"><span class="hs-identifier hs-var">roundFn</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727837"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">datetime</span><span class="hs-special">,</span><span>
</span><span id="line-286"></span><span>                    </span><span class="hs-comment">-- NOTE: No need to convert the distance to the requested</span><span>
</span><span id="line-287"></span><span>                    </span><span class="hs-comment">-- distance here, as mkChartDataSets will take care of it.</span><span>
</span><span id="line-288"></span><span>                    </span><span class="annot"><span class="annottext">distance :: Distance d a
</span><a href="Pacer.Command.Chart.Data.Activity.html#distance"><span class="hs-identifier hs-var">distance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727837"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">distance</span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>                    </span><span class="annot"><span class="annottext">duration :: Duration a
</span><a href="Pacer.Command.Chart.Data.Activity.html#duration"><span class="hs-identifier hs-var">duration</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727837"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">duration</span><span class="hs-special">,</span><span>
</span><span id="line-290"></span><span>                    </span><span class="annot"><span class="annottext">labels :: Set Label
</span><a href="Pacer.Command.Chart.Data.Activity.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Label
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span>
</span><span id="line-291"></span><span>                    </span><span class="annot"><span class="annottext">title :: Maybe Text
</span><a href="Pacer.Command.Chart.Data.Activity.html#title"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-292"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>        </span><span class="annot"><a href="#local-6989586621679727815"><span class="hs-identifier hs-type">groupByPeriod</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-295"></span><span>          </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-296"></span><span>          </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Monad.html/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727800"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>        </span><span id="local-6989586621679727815"><span class="annot"><span class="annottext">groupByPeriod :: NESeq (SomeActivity a) -&gt; Eff es (NESeq (NESeq (SomeActivity a)))
</span><a href="#local-6989586621679727815"><span class="hs-identifier hs-var hs-var">groupByPeriod</span></a></span></span><span> </span><span id="local-6989586621679727872"><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727872"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679727873"><span class="annot"><span class="annottext">xs :: NESeq (NESeq (SomeActivity a))
</span><a href="#local-6989586621679727873"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>                </span><span class="annot"><span class="annottext">(SomeActivity a -&gt; SomeActivity a -&gt; Bool)
-&gt; NESeq (SomeActivity a) -&gt; NESeq (NESeq (SomeActivity a))
forall a. (a -&gt; a -&gt; Bool) -&gt; NESeq a -&gt; NESeq (NESeq a)
</span><a href="Pacer.Utils.html#neSeqGroupBy"><span class="hs-identifier hs-var">U.neSeqGroupBy</span></a></span><span>
</span><span id="line-300"></span><span>                  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679727875"><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727875"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679727876"><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727876"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp -&gt; Bool
</span><a href="#local-6989586621679727816"><span class="hs-identifier hs-var">compPeriod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeActivity a -&gt; Timestamp
</span><a href="#local-6989586621679727877"><span class="hs-identifier hs-var">toDatetime</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727875"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeActivity a -&gt; Timestamp
</span><a href="#local-6989586621679727877"><span class="hs-identifier hs-var">toDatetime</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727876"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                  </span><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727872"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>          </span><span class="hs-comment">-- We should only do this when the level is debug and verbosity,</span><span>
</span><span id="line-304"></span><span>          </span><span class="hs-comment">-- since the json output can be very large. Furthermore, we</span><span>
</span><span id="line-305"></span><span>          </span><span class="hs-comment">-- want to guard all of this logic first since we do not want to</span><span>
</span><span id="line-306"></span><span>          </span><span class="hs-comment">-- unnecessarily decode the json to text, unless we are actually</span><span>
</span><span id="line-307"></span><span>          </span><span class="hs-comment">-- going to use it.</span><span>
</span><span id="line-308"></span><span>          </span><span id="local-6989586621679727878"><span class="annot"><span class="annottext">LogEnv
</span><a href="#local-6989586621679727878"><span class="hs-identifier hs-var">logEnv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (es :: [Effect]).
(HasCallStack, Reader r :&gt; es) =&gt;
Eff es r
</span><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Reader.Static.html/Effectful.Reader.Static.html#ask"><span class="hs-identifier hs-var">ask</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Pacer.Configuration.Env.Types.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span>
</span><span id="line-309"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogEnv
</span><a href="#local-6989586621679727878"><span class="hs-identifier hs-var">logEnv</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">logLevel</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LogEnv
</span><a href="#local-6989586621679727878"><span class="hs-identifier hs-var">logEnv</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">logVerbosity</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-310"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/logger-effectful-0.1-4c462c8d83799fc5c4900b79f30134a510b541d670854fe1dc3097beacce1d6c/share/doc/html/src/Effectful.Logger.Dynamic.html/Effectful.Logger.Dynamic.html#LevelDebug"><span class="hs-identifier hs-var">LevelDebug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LogVerbosity
</span><a href="Pacer.Configuration.Logging.html#LogV1"><span class="hs-identifier hs-var">LogV1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-311"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679727880"><span class="annot"><span class="annottext">json :: ByteString
</span><a href="#local-6989586621679727880"><span class="hs-identifier hs-var hs-var">json</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LazyByteString -&gt; ByteString
</span><a href="Pacer.Prelude.html#toStrictBS"><span class="hs-identifier hs-var">toStrictBS</span></a></span><span> </span><span class="annot"><span class="annottext">(LazyByteString -&gt; ByteString) -&gt; LazyByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NESeq (NESeq (SomeActivity a)) -&gt; LazyByteString
forall a. ToJSON a =&gt; a -&gt; LazyByteString
</span><a href="Pacer.Utils.html#encodePretty"><span class="hs-identifier hs-var">U.encodePretty</span></a></span><span> </span><span class="annot"><span class="annottext">NESeq (NESeq (SomeActivity a))
</span><a href="#local-6989586621679727873"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-312"></span><span>              </span><span id="local-6989586621679727883"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679727883"><span class="hs-identifier hs-var">jsonTxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Eff es Text
forall (m :: * -&gt; *).
(HasCallStack, MonadThrow m) =&gt;
ByteString -&gt; m Text
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/fs-utils-0.1-98c482801d5ef5925933b0f33e814691f8f0113763e0f5183e0d5b691f3f61e1/share/doc/html/src/FileSystem.UTF8.html/FileSystem.UTF8.html#decodeUtf8ThrowM"><span class="hs-identifier hs-var">decodeUtf8ThrowM</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679727880"><span class="hs-identifier hs-var">json</span></a></span><span>
</span><span id="line-313"></span><span>              </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/logger-effectful-0.1-4c462c8d83799fc5c4900b79f30134a510b541d670854fe1dc3097beacce1d6c/share/doc/html/src/Effectful.Logger.Dynamic.html/Effectful.Logger.Dynamic.html#logDebug"><span class="hs-identifier hs-type">Logger.logDebug</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679727883"><span class="hs-identifier hs-var">jsonTxt</span></a></span><span>
</span><span id="line-314"></span><span>            </span><span class="annot"><span class="annottext">(Maybe LogLevel, LogVerbosity)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Eff es ()
forall a. a -&gt; Eff es a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>          </span><span class="hs-identifier">pure</span><span> </span><span class="annot"><span class="annottext">NESeq (NESeq (SomeActivity a))
</span><a href="#local-6989586621679727873"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="#local-6989586621679727877"><span class="hs-identifier hs-type">toDatetime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727801"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Timestamp.Internal.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679727877"><span class="annot"><span class="annottext">toDatetime :: SomeActivity a -&gt; Timestamp
</span><a href="#local-6989586621679727877"><span class="hs-identifier hs-var hs-var">toDatetime</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679727892"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727892"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727892"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">datetime</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#mkChartDataSets"><span class="hs-identifier hs-type">mkChartDataSets</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679727224"><span class="annot"><a href="#local-6989586621679727224"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Integer.html/Numeric.Convert.Integer.html#From%2124"><span class="hs-identifier hs-type">From&#8484;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727224"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679727224"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Algebra.Semifield.html/Numeric.Algebra.Semifield.html#Semifield"><span class="hs-identifier hs-type">Semifield</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727224"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679727224"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Real.html/Numeric.Convert.Real.html#To%211D"><span class="hs-identifier hs-type">To&#8477;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727224"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#DistanceUnit"><span class="hs-identifier hs-type">DistanceUnit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#ChartRequest"><span class="hs-identifier hs-type">ChartRequest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727224"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727224"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#ChartData"><span class="hs-identifier hs-type">ChartData</span></a></span><span>
</span><span id="line-333"></span><span id="mkChartDataSets"><span class="annot"><span class="annottext">mkChartDataSets :: forall a.
(From&#8484; a, Ord a, Semifield a, Show a, To&#8477; a) =&gt;
DistanceUnit
-&gt; ChartRequest a -&gt; NESeq (SomeActivity a) -&gt; ChartData
</span><a href="Pacer.Command.Chart.Data.ChartData.html#mkChartDataSets"><span class="hs-identifier hs-var hs-var">mkChartDataSets</span></a></span></span><span> </span><span class="hs-glyph">@</span><span id="local-6989586621679727899"><span class="annot"><a href="#local-6989586621679727899"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679727900"><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727900"><span class="hs-identifier hs-var">finalDistUnit</span></a></span></span><span> </span><span id="local-6989586621679727901"><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727901"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span id="local-6989586621679727902"><span class="annot"><span class="annottext">activities :: NESeq (SomeActivity a)
</span><a href="#local-6989586621679727902"><span class="hs-identifier hs-var">activities</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span id="local-6989586621679727907"><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727907"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-type">:&lt;||</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (SomeActivity a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727901"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">y1Axis</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><span class="annottext">Maybe YAxisType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679727908"><span class="annot"><span class="annottext">vals :: NESeq (Timestamp, Double)
</span><a href="#local-6989586621679727908"><span class="hs-identifier hs-var hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sing d
-&gt; (SingI d =&gt; NESeq (Timestamp, Double))
-&gt; NESeq (Timestamp, Double)
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727907"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">((SingI d =&gt; NESeq (Timestamp, Double))
 -&gt; NESeq (Timestamp, Double))
-&gt; (SingI d =&gt; NESeq (Timestamp, Double))
-&gt; NESeq (Timestamp, Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SomeActivity a -&gt; NESeq (Timestamp, Double))
-&gt; NESeq (SomeActivity a) -&gt; NESeq (Timestamp, Double)
forall m a. Semigroup m =&gt; (a -&gt; m) -&gt; NESeq a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable1 t, Semigroup m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap1</span></span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; NESeq (Timestamp, Double)
</span><a href="#local-6989586621679727914"><span class="hs-identifier hs-var">toAccY</span></a></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727902"><span class="hs-identifier hs-var">activities</span></a></span><span>
</span><span id="line-337"></span><span>          </span><span id="local-6989586621679727915"><span class="annot"><span class="annottext">yType :: YAxisType
</span><a href="#local-6989586621679727915"><span class="hs-identifier hs-var hs-var">yType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727901"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">yAxis</span><span>
</span><span id="line-338"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ChartY -&gt; ChartData
</span><a href="Pacer.Command.Chart.Data.ChartData.html#ChartDataY"><span class="hs-identifier hs-var">ChartDataY</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NESeq (Timestamp, Double) -&gt; YAxisType -&gt; DistanceUnit -&gt; ChartY
</span><a href="Pacer.Command.Chart.Data.ChartData.html#MkChartY"><span class="hs-identifier hs-var">MkChartY</span></a></span><span> </span><span class="annot"><span class="annottext">NESeq (Timestamp, Double)
</span><a href="#local-6989586621679727908"><span class="hs-identifier hs-var">vals</span></a></span><span> </span><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727915"><span class="hs-identifier hs-var">yType</span></a></span><span> </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727900"><span class="hs-identifier hs-var">finalDistUnit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679727916"><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727916"><span class="hs-identifier hs-var">y1Type</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679727917"><span class="annot"><span class="annottext">vals :: NESeq (Timestamp, Double, Double)
</span><a href="#local-6989586621679727917"><span class="hs-identifier hs-var hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sing d
-&gt; (SingI d =&gt; NESeq (Timestamp, Double, Double))
-&gt; NESeq (Timestamp, Double, Double)
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727907"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">((SingI d =&gt; NESeq (Timestamp, Double, Double))
 -&gt; NESeq (Timestamp, Double, Double))
-&gt; (SingI d =&gt; NESeq (Timestamp, Double, Double))
-&gt; NESeq (Timestamp, Double, Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SomeActivity a -&gt; NESeq (Timestamp, Double, Double))
-&gt; NESeq (SomeActivity a) -&gt; NESeq (Timestamp, Double, Double)
forall m a. Semigroup m =&gt; (a -&gt; m) -&gt; NESeq a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable1 t, Semigroup m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">YAxisType -&gt; SomeActivity a -&gt; NESeq (Timestamp, Double, Double)
</span><a href="#local-6989586621679727921"><span class="hs-identifier hs-var">toAccY1</span></a></span><span> </span><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727916"><span class="hs-identifier hs-var">y1Type</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivity a)
</span><a href="#local-6989586621679727902"><span class="hs-identifier hs-var">activities</span></a></span><span>
</span><span id="line-341"></span><span>          </span><span id="local-6989586621679727922"><span class="annot"><span class="annottext">yType :: YAxisType
</span><a href="#local-6989586621679727922"><span class="hs-identifier hs-var hs-var">yType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727901"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">yAxis</span><span>
</span><span id="line-342"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ChartY1 -&gt; ChartData
</span><a href="Pacer.Command.Chart.Data.ChartData.html#ChartDataY1"><span class="hs-identifier hs-var">ChartDataY1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NESeq (Timestamp, Double, Double)
-&gt; YAxisType -&gt; YAxisType -&gt; DistanceUnit -&gt; ChartY1
</span><a href="Pacer.Command.Chart.Data.ChartData.html#MkChartY1"><span class="hs-identifier hs-var">MkChartY1</span></a></span><span> </span><span class="annot"><span class="annottext">NESeq (Timestamp, Double, Double)
</span><a href="#local-6989586621679727917"><span class="hs-identifier hs-var">vals</span></a></span><span> </span><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727922"><span class="hs-identifier hs-var">yType</span></a></span><span> </span><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727916"><span class="hs-identifier hs-var">y1Type</span></a></span><span> </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727900"><span class="hs-identifier hs-var">finalDistUnit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="#local-6989586621679727914"><span class="hs-identifier hs-type">toAccY</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#AccY"><span class="hs-identifier hs-type">AccY</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679727914"><span class="annot"><span class="annottext">toAccY :: SomeActivity a -&gt; NESeq (Timestamp, Double)
</span><a href="#local-6989586621679727914"><span class="hs-identifier hs-var hs-var">toAccY</span></a></span></span><span> </span><span id="local-6989586621679727923"><span class="annot"><span class="annottext">sr :: SomeActivity a
</span><a href="#local-6989586621679727923"><span class="hs-identifier hs-var">sr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679727925"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727925"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Timestamp, Double) -&gt; NESeq (Timestamp, Double)
forall a. a -&gt; NESeq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#singleton"><span class="hs-identifier hs-var">NESeq.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727925"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">datetime</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; Double
</span><a href="#local-6989586621679727927"><span class="hs-identifier hs-var">toY</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727923"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="#local-6989586621679727921"><span class="hs-identifier hs-type">toAccY1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisType"><span class="hs-identifier hs-type">YAxisType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#AccY1"><span class="hs-identifier hs-type">AccY1</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621679727921"><span class="annot"><span class="annottext">toAccY1 :: YAxisType -&gt; SomeActivity a -&gt; NESeq (Timestamp, Double, Double)
</span><a href="#local-6989586621679727921"><span class="hs-identifier hs-var hs-var">toAccY1</span></a></span></span><span> </span><span id="local-6989586621679727928"><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727928"><span class="hs-identifier hs-var">yAxisType</span></a></span></span><span> </span><span id="local-6989586621679727929"><span class="annot"><span class="annottext">sr :: SomeActivity a
</span><a href="#local-6989586621679727929"><span class="hs-identifier hs-var">sr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679727931"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727931"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><span class="annottext">(Timestamp, Double, Double) -&gt; NESeq (Timestamp, Double, Double)
forall a. a -&gt; NESeq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#singleton"><span class="hs-identifier hs-var">NESeq.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727931"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">datetime</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; Double
</span><a href="#local-6989586621679727927"><span class="hs-identifier hs-var">toY</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727929"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">YAxisType -&gt; SomeActivity a -&gt; Double
</span><a href="#local-6989586621679727932"><span class="hs-identifier hs-var">toYHelper</span></a></span><span> </span><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727928"><span class="hs-identifier hs-var">yAxisType</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679727929"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><a href="#local-6989586621679727927"><span class="hs-identifier hs-type">toY</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679727927"><span class="annot"><span class="annottext">toY :: SomeActivity a -&gt; Double
</span><a href="#local-6989586621679727927"><span class="hs-identifier hs-var hs-var">toY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">YAxisType -&gt; SomeActivity a -&gt; Double
</span><a href="#local-6989586621679727932"><span class="hs-identifier hs-var">toYHelper</span></a></span><span> </span><span class="annot"><span class="annottext">ChartRequest a
</span><a href="#local-6989586621679727901"><span class="hs-identifier hs-var">request</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">yAxis</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><a href="#local-6989586621679727932"><span class="hs-identifier hs-type">toYHelper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisType"><span class="hs-identifier hs-type">YAxisType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621679727932"><span class="annot"><span class="annottext">toYHelper :: YAxisType -&gt; SomeActivity a -&gt; Double
</span><a href="#local-6989586621679727932"><span class="hs-identifier hs-var hs-var">toYHelper</span></a></span></span><span> </span><span id="local-6989586621679727933"><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727933"><span class="hs-identifier hs-var">axisType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span id="local-6989586621679727940"><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727940"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679727941"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727941"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">YAxisType
</span><a href="#local-6989586621679727933"><span class="hs-identifier hs-var">axisType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><span class="annottext">YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisDistance"><span class="hs-identifier hs-var">YAxisDistance</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><span class="annottext">Sing d -&gt; (SingI d =&gt; Double) -&gt; Double
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727940"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">((SingI d =&gt; Double) -&gt; Double) -&gt; (SingI d =&gt; Double) -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Positive a -&gt; Double
forall a. (HasCallStack, To&#8477; a) =&gt; a -&gt; Double
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Real.html/Numeric.Convert.Real.html#to%211D"><span class="hs-identifier hs-var">to&#8477;</span></a></span><span> </span><span class="annot"><span class="annottext">(Positive a -&gt; Double) -&gt; Positive a -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727900"><span class="hs-identifier hs-var">finalDistUnit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-358"></span><span>          </span><span class="hs-comment">-- NOTE: [Brackets with OverloadedRecordDot]</span><span>
</span><span id="line-359"></span><span>          </span><span class="hs-comment">-- REVIEW: Should this be (DistU.convertDistance Meter)? Or do we</span><span>
</span><span id="line-360"></span><span>          </span><span class="hs-comment">-- only allow km/mi in charts?</span><span>
</span><span id="line-361"></span><span>          </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="Pacer.Data.Distance.Units.html#Meter"><span class="hs-identifier hs-var">Meter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity d a -&gt; ConvertedDistance (Activity d a) 'Kilometer
forall a.
(ConvertDistance a, ToConstraints a 'Kilometer) =&gt;
a -&gt; ConvertedDistance a 'Kilometer
</span><a href="Pacer.Data.Distance.Units.html#convertToKilometers"><span class="hs-identifier hs-var">DistU.convertToKilometers</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727941"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span class="hs-identifier">distance</span><span class="hs-operator">.</span><span class="hs-identifier">unDistance</span><span>
</span><span id="line-362"></span><span>          </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="Pacer.Data.Distance.Units.html#Kilometer"><span class="hs-identifier hs-var">Kilometer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity d a -&gt; ConvertedDistance (Activity d a) 'Kilometer
forall a.
(ConvertDistance a, ToConstraints a 'Kilometer) =&gt;
a -&gt; ConvertedDistance a 'Kilometer
</span><a href="Pacer.Data.Distance.Units.html#convertToKilometers"><span class="hs-identifier hs-var">DistU.convertToKilometers</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727941"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span class="hs-identifier">distance</span><span class="hs-operator">.</span><span class="hs-identifier">unDistance</span><span>
</span><span id="line-363"></span><span>          </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="Pacer.Data.Distance.Units.html#Mile"><span class="hs-identifier hs-var">Mile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
(SingI 'Mile, ConvertDistance a, ToConstraints a 'Mile) =&gt;
a -&gt; ConvertedDistance a 'Mile
Activity d a -&gt; ConvertedDistance (Activity d a) 'Mile
forall (e :: DistanceUnit) -&gt;
forall a.
(SingI e, ConvertDistance a, ToConstraints a e) =&gt;
a -&gt; ConvertedDistance a e
forall a.
(ConvertDistance a, ToConstraints a 'Mile) =&gt;
a -&gt; ConvertedDistance a 'Mile
</span><a href="Pacer.Data.Distance.Units.html#convertDistance"><span class="hs-identifier hs-var">DistU.convertDistance</span></a></span><span> </span><span class="hs-identifier">Mile</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727941"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span class="hs-identifier">distance</span><span class="hs-operator">.</span><span class="hs-identifier">unDistance</span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><span class="annottext">YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisDuration"><span class="hs-identifier hs-var">YAxisDuration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Positive a -&gt; Double
forall a. (HasCallStack, To&#8477; a) =&gt; a -&gt; Double
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Real.html/Numeric.Convert.Real.html#to%211D"><span class="hs-identifier hs-var">to&#8477;</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727941"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">duration</span><span class="hs-operator">.</span><span class="hs-identifier">unDuration</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">YAxisType
</span><a href="Pacer.Command.Chart.Data.ChartRequest.html#YAxisPace"><span class="hs-identifier hs-var">YAxisPace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><span class="annottext">Sing d -&gt; (SingI d =&gt; Double) -&gt; Double
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679727940"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">((SingI d =&gt; Double) -&gt; Double) -&gt; (SingI d =&gt; Double) -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Positive a -&gt; Double
forall a. (HasCallStack, To&#8477; a) =&gt; a -&gt; Double
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Real.html/Numeric.Convert.Real.html#to%211D"><span class="hs-identifier hs-var">to&#8477;</span></a></span><span> </span><span class="annot"><span class="annottext">(Positive a -&gt; Double) -&gt; Positive a -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="#local-6989586621679727900"><span class="hs-identifier hs-var">finalDistUnit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-367"></span><span>          </span><span class="hs-comment">-- REVIEW: Ideally this would error, not convert. But probably we</span><span>
</span><span id="line-368"></span><span>          </span><span class="hs-comment">-- already throw errors somewhere, and the Meters are only here</span><span>
</span><span id="line-369"></span><span>          </span><span class="hs-comment">-- because we haven't proven to GHC that it is impossible. It would</span><span>
</span><span id="line-370"></span><span>          </span><span class="hs-comment">-- be nice to come up with something more robust.</span><span>
</span><span id="line-371"></span><span>          </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="Pacer.Data.Distance.Units.html#Meter"><span class="hs-identifier hs-var">Meter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Activity 'Kilometer a -&gt; Positive a
forall {d :: DistanceUnit} {a}.
(PaceDistF d, MGroup a) =&gt;
Activity d a -&gt; Positive a
</span><a href="#local-6989586621679727983"><span class="hs-identifier hs-var">activityToPace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity d a -&gt; ConvertedDistance (Activity d a) 'Kilometer
forall a.
(ConvertDistance a, ToConstraints a 'Kilometer) =&gt;
a -&gt; ConvertedDistance a 'Kilometer
</span><a href="Pacer.Data.Distance.Units.html#convertToKilometers"><span class="hs-identifier hs-var">DistU.convertToKilometers</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727941"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>          </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="Pacer.Data.Distance.Units.html#Kilometer"><span class="hs-identifier hs-var">Kilometer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Activity 'Kilometer a -&gt; Positive a
forall {d :: DistanceUnit} {a}.
(PaceDistF d, MGroup a) =&gt;
Activity d a -&gt; Positive a
</span><a href="#local-6989586621679727983"><span class="hs-identifier hs-var">activityToPace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity d a -&gt; ConvertedDistance (Activity d a) 'Kilometer
forall a.
(ConvertDistance a, ToConstraints a 'Kilometer) =&gt;
a -&gt; ConvertedDistance a 'Kilometer
</span><a href="Pacer.Data.Distance.Units.html#convertToKilometers"><span class="hs-identifier hs-var">DistU.convertToKilometers</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727941"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>          </span><span class="annot"><span class="annottext">DistanceUnit
</span><a href="Pacer.Data.Distance.Units.html#Mile"><span class="hs-identifier hs-var">Mile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Activity 'Mile a -&gt; Positive a
forall {d :: DistanceUnit} {a}.
(PaceDistF d, MGroup a) =&gt;
Activity d a -&gt; Positive a
</span><a href="#local-6989586621679727983"><span class="hs-identifier hs-var">activityToPace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
(SingI 'Mile, ConvertDistance a, ToConstraints a 'Mile) =&gt;
a -&gt; ConvertedDistance a 'Mile
Activity d a -&gt; ConvertedDistance (Activity d a) 'Mile
forall (e :: DistanceUnit) -&gt;
forall a.
(SingI e, ConvertDistance a, ToConstraints a e) =&gt;
a -&gt; ConvertedDistance a e
forall a.
(ConvertDistance a, ToConstraints a 'Mile) =&gt;
a -&gt; ConvertedDistance a 'Mile
</span><a href="Pacer.Data.Distance.Units.html#convertDistance"><span class="hs-identifier hs-var">DistU.convertDistance</span></a></span><span> </span><span class="annot"><a href="Pacer.Data.Distance.Units.html#Mile"><span class="hs-identifier hs-type">Mile</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727941"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>          </span><span id="local-6989586621679727983"><span class="annot"><span class="annottext">activityToPace :: Activity d a -&gt; Positive a
</span><a href="#local-6989586621679727983"><span class="hs-identifier hs-var hs-var">activityToPace</span></a></span></span><span> </span><span id="local-6989586621679727995"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727995"><span class="hs-identifier hs-var">activityUnits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-376"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Activity d a -&gt; Pace d a
forall a (d :: DistanceUnit).
(MGroup a, PaceDistF d) =&gt;
Activity d a -&gt; Pace d a
</span><a href="Pacer.Command.Chart.Data.Activity.html#derivePace"><span class="hs-identifier hs-var">Activity.derivePace</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679727995"><span class="hs-identifier hs-var">activityUnits</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span class="hs-identifier">unPace</span><span class="hs-operator">.</span><span class="hs-identifier">unDuration</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="annot"><a href="Pacer.Command.Chart.Data.ChartData.html#filterActivities"><span class="hs-identifier hs-type">filterActivities</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679727226"><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Convert.Integer.html/Numeric.Convert.Integer.html#From%2124"><span class="hs-identifier hs-type">From&#8484;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Algebra.MetricSpace.html/Numeric.Algebra.MetricSpace.html#MetricSpace"><span class="hs-identifier hs-type">MetricSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/algebra-simple-0.1-e08841e4ef5e27130165fb6c9d8f3eecf612d07dfc2109640e7761e43538eddd/share/doc/html/src/Numeric.Algebra.Semifield.html/Numeric.Algebra.Semifield.html#Semifield"><span class="hs-identifier hs-type">Semifield</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivitiesKey"><span class="hs-identifier hs-type">SomeActivitiesKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.html#FilterExpr"><span class="hs-identifier hs-type">FilterExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-388"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span id="filterActivities"><span class="annot"><span class="annottext">filterActivities :: forall a.
(From&#8484; a, MetricSpace a, Ord a, Semifield a, Show a) =&gt;
NESeq (SomeActivitiesKey a)
-&gt; [FilterExpr a] -&gt; Seq (SomeActivity a)
</span><a href="Pacer.Command.Chart.Data.ChartData.html#filterActivities"><span class="hs-identifier hs-var hs-var">filterActivities</span></a></span></span><span> </span><span class="hs-glyph">@</span><span id="local-6989586621679728016"><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679728017"><span class="annot"><span class="annottext">NESeq (SomeActivitiesKey a)
</span><a href="#local-6989586621679728017"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679728018"><span class="annot"><span class="annottext">[FilterExpr a]
</span><a href="#local-6989586621679728018"><span class="hs-identifier hs-var">filters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">unSomeActivitiesKey</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SomeActivitiesKey a -&gt; SomeActivity a)
-&gt; Seq (SomeActivitiesKey a) -&gt; Seq (SomeActivity a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(SomeActivitiesKey a -&gt; Bool)
-&gt; NESeq (SomeActivitiesKey a) -&gt; Seq (SomeActivitiesKey a)
forall a. (a -&gt; Bool) -&gt; NESeq a -&gt; Seq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.html/Data.Sequence.NonEmpty.html#filter"><span class="hs-identifier hs-var">NESeq.filter</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivitiesKey a -&gt; Bool
</span><a href="#local-6989586621679728021"><span class="hs-identifier hs-var">filterActivity</span></a></span><span> </span><span class="annot"><span class="annottext">NESeq (SomeActivitiesKey a)
</span><a href="#local-6989586621679728017"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><a href="#local-6989586621679728021"><span class="hs-identifier hs-type">filterActivity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivitiesKey"><span class="hs-identifier hs-type">SomeActivitiesKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679728021"><span class="annot"><span class="annottext">filterActivity :: SomeActivitiesKey a -&gt; Bool
</span><a href="#local-6989586621679728021"><span class="hs-identifier hs-var hs-var">filterActivity</span></a></span></span><span> </span><span id="local-6989586621679728022"><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728022"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilterExpr a -&gt; Bool) -&gt; [FilterExpr a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilterType a -&gt; Bool) -&gt; FilterExpr a -&gt; Bool
forall a. (a -&gt; Bool) -&gt; Expr a -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeActivitiesKey a -&gt; FilterType a -&gt; Bool
</span><a href="#local-6989586621679728023"><span class="hs-identifier hs-var">applyFilter</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728022"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilterExpr a]
</span><a href="#local-6989586621679728018"><span class="hs-identifier hs-var">filters</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><a href="#local-6989586621679728023"><span class="hs-identifier hs-type">applyFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivitiesKey"><span class="hs-identifier hs-type">SomeActivitiesKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterType"><span class="hs-identifier hs-type">FilterType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679728023"><span class="annot"><span class="annottext">applyFilter :: SomeActivitiesKey a -&gt; FilterType a -&gt; Bool
</span><a href="#local-6989586621679728023"><span class="hs-identifier hs-var hs-var">applyFilter</span></a></span></span><span> </span><span id="local-6989586621679728024"><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728024"><span class="hs-identifier hs-var">srk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterLabel"><span class="hs-identifier hs-type">FilterLabel</span></a></span><span> </span><span id="local-6989586621679728025"><span class="annot"><span class="annottext">FilterSet &quot;label&quot; Label
</span><a href="#local-6989586621679728025"><span class="hs-identifier hs-var">lblSet</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Label -&gt; FilterSet &quot;label&quot; Label -&gt; Bool
forall b (p :: Symbol). Ord b =&gt; Set b -&gt; FilterSet p b -&gt; Bool
</span><a href="#local-6989586621679728026"><span class="hs-identifier hs-var">applyFilterSet</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728024"><span class="hs-identifier hs-var">srk</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">labels</span><span> </span><span class="annot"><span class="annottext">FilterSet &quot;label&quot; Label
</span><a href="#local-6989586621679728025"><span class="hs-identifier hs-var">lblSet</span></a></span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><a href="#local-6989586621679728023"><span class="hs-identifier hs-var">applyFilter</span></a></span><span> </span><span id="local-6989586621679728027"><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728027"><span class="hs-identifier hs-var">srk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterDate"><span class="hs-identifier hs-type">FilterDate</span></a></span><span> </span><span id="local-6989586621679728028"><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728028"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728029"><span class="annot"><span class="annottext">Moment
</span><a href="#local-6989586621679728029"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; FilterOpOrd -&gt; Moment -&gt; Bool
</span><a href="#local-6989586621679728030"><span class="hs-identifier hs-var">applyDate</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728027"><span class="hs-identifier hs-var">srk</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">unSomeActivitiesKey</span><span> </span><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728028"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Moment
</span><a href="#local-6989586621679728029"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><a href="#local-6989586621679728023"><span class="hs-identifier hs-var">applyFilter</span></a></span><span> </span><span id="local-6989586621679728031"><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728031"><span class="hs-identifier hs-var">srk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterDistance"><span class="hs-identifier hs-type">FilterDistance</span></a></span><span> </span><span id="local-6989586621679728032"><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728032"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728033"><span class="annot"><span class="annottext">SomeDistance a
</span><a href="#local-6989586621679728033"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; FilterOpOrd -&gt; SomeDistance a -&gt; Bool
</span><a href="#local-6989586621679728034"><span class="hs-identifier hs-var">applyDist</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728031"><span class="hs-identifier hs-var">srk</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">unSomeActivitiesKey</span><span> </span><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728032"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">SomeDistance a
</span><a href="#local-6989586621679728033"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><a href="#local-6989586621679728023"><span class="hs-identifier hs-var">applyFilter</span></a></span><span> </span><span id="local-6989586621679728035"><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728035"><span class="hs-identifier hs-var">srk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterDuration"><span class="hs-identifier hs-type">FilterDuration</span></a></span><span> </span><span id="local-6989586621679728036"><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728036"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728037"><span class="annot"><span class="annottext">Duration a
</span><a href="#local-6989586621679728037"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; FilterOpOrd -&gt; Duration a -&gt; Bool
</span><a href="#local-6989586621679728038"><span class="hs-identifier hs-var">applyDur</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728035"><span class="hs-identifier hs-var">srk</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">unSomeActivitiesKey</span><span> </span><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728036"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Duration a
</span><a href="#local-6989586621679728037"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><a href="#local-6989586621679728023"><span class="hs-identifier hs-var">applyFilter</span></a></span><span> </span><span id="local-6989586621679728039"><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728039"><span class="hs-identifier hs-var">srk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterPace"><span class="hs-identifier hs-type">FilterPace</span></a></span><span> </span><span id="local-6989586621679728040"><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728040"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728041"><span class="annot"><span class="annottext">SomePace a
</span><a href="#local-6989586621679728041"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; FilterOpOrd -&gt; SomePace a -&gt; Bool
</span><a href="#local-6989586621679728042"><span class="hs-identifier hs-var">applyPace</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728039"><span class="hs-identifier hs-var">srk</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">unSomeActivitiesKey</span><span> </span><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728040"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">SomePace a
</span><a href="#local-6989586621679728041"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="#local-6989586621679728023"><span class="hs-identifier hs-var">applyFilter</span></a></span><span> </span><span id="local-6989586621679728043"><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728043"><span class="hs-identifier hs-var">srk</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Filter.html#FilterType"><span class="hs-identifier hs-type">FilterType</span></a></span><span> </span><span id="local-6989586621679728044"><span class="annot"><span class="annottext">FilterElem &quot;type&quot; ActivityType
</span><a href="#local-6989586621679728044"><span class="hs-identifier hs-var">fe</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeActivitiesKey a
</span><a href="#local-6989586621679728043"><span class="hs-identifier hs-var">srk</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">unSomeActivitiesKey</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-401"></span><span>      </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679728048"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679728048"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679728048"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">atype</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679728049"><span class="annot"><span class="annottext">ActivityType
</span><a href="#local-6989586621679728049"><span class="hs-identifier hs-var">atype</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActivityType -&gt; FilterElem &quot;type&quot; ActivityType -&gt; Bool
forall b (p :: Symbol). Ord b =&gt; b -&gt; FilterElem p b -&gt; Bool
</span><a href="#local-6989586621679728050"><span class="hs-identifier hs-var">applyFilterElem</span></a></span><span> </span><span class="annot"><span class="annottext">ActivityType
</span><a href="#local-6989586621679728049"><span class="hs-identifier hs-var">atype</span></a></span><span> </span><span class="annot"><span class="annottext">FilterElem &quot;type&quot; ActivityType
</span><a href="#local-6989586621679728044"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><span class="annottext">Maybe ActivityType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621679727359"><span id="local-6989586621679727360"><span class="annot"><a href="#local-6989586621679728050"><span class="hs-identifier hs-type">applyFilterElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679727359"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679727359"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterElem"><span class="hs-identifier hs-type">FilterElem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727360"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727359"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-406"></span><span>    </span><span id="local-6989586621679728050"><span class="annot"><span class="annottext">applyFilterElem :: forall b (p :: Symbol). Ord b =&gt; b -&gt; FilterElem p b -&gt; Bool
</span><a href="#local-6989586621679728050"><span class="hs-identifier hs-var hs-var">applyFilterElem</span></a></span></span><span> </span><span id="local-6989586621679728056"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728056"><span class="hs-identifier hs-var">actVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-407"></span><span>      </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterElemEq"><span class="hs-identifier hs-type">FilterElemEq</span></a></span><span> </span><span id="local-6989586621679728058"><span class="annot"><span class="annottext">FilterOpEq
</span><a href="#local-6989586621679728058"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728059"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728059"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilterOpEq -&gt; b -&gt; b -&gt; Bool
forall b. Eq b =&gt; FilterOpEq -&gt; b -&gt; b -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Eq.html#toFun"><span class="hs-identifier hs-var">Eq.toFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterOpEq
</span><a href="#local-6989586621679728058"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728056"><span class="hs-identifier hs-var">actVal</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728059"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-408"></span><span>      </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterElemExists"><span class="hs-identifier hs-type">FilterElemExists</span></a></span><span> </span><span id="local-6989586621679728062"><span class="annot"><span class="annottext">FilterElemOpSet
</span><a href="#local-6989586621679728062"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728063"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728063"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilterElemOpSet -&gt; b -&gt; Set b -&gt; Bool
forall a. Ord a =&gt; FilterElemOpSet -&gt; a -&gt; Set a -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Set.html#memberFun"><span class="hs-identifier hs-var">ESet.memberFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterElemOpSet
</span><a href="#local-6989586621679728062"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728056"><span class="hs-identifier hs-var">actVal</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728063"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span>    </span><span class="annot"><a href="#local-6989586621679728026"><span class="hs-identifier hs-type">applyFilterSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679727351"><span class="annot"><a href="#local-6989586621679727351"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679727352"><span class="annot"><a href="#local-6989586621679727352"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679727351"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679727351"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterSet"><span class="hs-identifier hs-type">FilterSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727352"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679727351"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679728026"><span class="annot"><span class="annottext">applyFilterSet :: forall b (p :: Symbol). Ord b =&gt; Set b -&gt; FilterSet p b -&gt; Bool
</span><a href="#local-6989586621679728026"><span class="hs-identifier hs-var hs-var">applyFilterSet</span></a></span></span><span> </span><span id="local-6989586621679728070"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728070"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterSetElem"><span class="hs-identifier hs-type">FilterSetElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterElemEq"><span class="hs-identifier hs-type">FilterElemEq</span></a></span><span> </span><span id="local-6989586621679728072"><span class="annot"><span class="annottext">FilterOpEq
</span><a href="#local-6989586621679728072"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728073"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728073"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilterOpEq -&gt; Set b -&gt; b -&gt; Bool
forall a. Ord a =&gt; FilterOpEq -&gt; Set a -&gt; a -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Set.html#existsElemFun"><span class="hs-identifier hs-var">ESet.existsElemFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterOpEq
</span><a href="#local-6989586621679728072"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728070"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728073"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterSetElem"><span class="hs-identifier hs-type">FilterSetElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterElemExists"><span class="hs-identifier hs-type">FilterElemExists</span></a></span><span> </span><span id="local-6989586621679728075"><span class="annot"><span class="annottext">FilterElemOpSet
</span><a href="#local-6989586621679728075"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728076"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728076"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilterElemOpSet -&gt; Set b -&gt; Set b -&gt; Bool
forall a. Ord a =&gt; FilterElemOpSet -&gt; Set a -&gt; Set a -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Set.html#existsSetFun"><span class="hs-identifier hs-var">ESet.existsSetFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterElemOpSet
</span><a href="#local-6989586621679728075"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728070"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728076"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-414"></span><span>      </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterSetHasElem"><span class="hs-identifier hs-type">FilterSetHasElem</span></a></span><span> </span><span id="local-6989586621679728079"><span class="annot"><span class="annottext">FilterSetOpElem
</span><a href="#local-6989586621679728079"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728080"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728080"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilterSetOpElem -&gt; Set b -&gt; b -&gt; Bool
forall a. Ord a =&gt; FilterSetOpElem -&gt; Set a -&gt; a -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Set.html#hasElemFun"><span class="hs-identifier hs-var">ESet.hasElemFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterSetOpElem
</span><a href="#local-6989586621679728079"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728070"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679728080"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Set.html#FilterSetComp"><span class="hs-identifier hs-type">FilterSetComp</span></a></span><span> </span><span id="local-6989586621679728083"><span class="annot"><span class="annottext">FilterSetOpSet
</span><a href="#local-6989586621679728083"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728084"><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728084"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilterSetOpSet -&gt; Set b -&gt; Set b -&gt; Bool
forall b. Ord b =&gt; FilterSetOpSet -&gt; Set b -&gt; Set b -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Set.html#compFun"><span class="hs-identifier hs-var">ESet.compFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterSetOpSet
</span><a href="#local-6989586621679728083"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728070"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Set b
</span><a href="#local-6989586621679728084"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><a href="#local-6989586621679728030"><span class="hs-identifier hs-type">applyDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Ord.html#FilterOpOrd"><span class="hs-identifier hs-type">FilterOpOrd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Time.Moment.html#Moment"><span class="hs-identifier hs-type">Moment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-418"></span><span>    </span><span id="local-6989586621679728030"><span class="annot"><span class="annottext">applyDate :: SomeActivity a -&gt; FilterOpOrd -&gt; Moment -&gt; Bool
</span><a href="#local-6989586621679728030"><span class="hs-identifier hs-var hs-var">applyDate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679728089"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679728089"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679728090"><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728090"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728091"><span class="annot"><span class="annottext">Moment
</span><a href="#local-6989586621679728091"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilterOpOrd -&gt; Moment -&gt; Moment -&gt; Bool
forall b. IOrd b =&gt; FilterOpOrd -&gt; b -&gt; b -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Ord.html#toIFun"><span class="hs-identifier hs-var">Ord.toIFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728090"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Moment
</span><a href="#local-6989586621679728093"><span class="hs-identifier hs-var">activityMoment</span></a></span><span> </span><span class="annot"><span class="annottext">Moment
</span><a href="#local-6989586621679728091"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-420"></span><span>        </span><span id="local-6989586621679728093"><span class="annot"><span class="annottext">activityMoment :: Moment
</span><a href="#local-6989586621679728093"><span class="hs-identifier hs-var hs-var">activityMoment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Timestamp -&gt; Moment
</span><a href="Pacer.Command.Chart.Data.Time.Moment.html#MomentTimestamp"><span class="hs-identifier hs-var">MomentTimestamp</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679728089"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">datetime</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><a href="#local-6989586621679728034"><span class="hs-identifier hs-type">applyDist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Ord.html#FilterOpOrd"><span class="hs-identifier hs-type">FilterOpOrd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.html#SomeDistance"><span class="hs-identifier hs-type">SomeDistance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621679728034"><span class="annot"><span class="annottext">applyDist :: SomeActivity a -&gt; FilterOpOrd -&gt; SomeDistance a -&gt; Bool
</span><a href="#local-6989586621679728034"><span class="hs-identifier hs-var hs-var">applyDist</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span class="hs-glyph">@</span><span id="local-6989586621679728094"><span class="annot"><a href="#local-6989586621679728094"><span class="hs-identifier hs-type hs-type">activityDist</span></a></span></span><span> </span><span id="local-6989586621679728095"><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679728095"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679728096"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679728096"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679728097"><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728097"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679728098"><span class="annot"><span class="annottext">SomeDistance a
</span><a href="#local-6989586621679728098"><span class="hs-identifier hs-var">fDist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><span class="annottext">Sing d -&gt; (SingI d =&gt; Bool) -&gt; Bool
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679728095"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">((SingI d =&gt; Bool) -&gt; Bool) -&gt; (SingI d =&gt; Bool) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilterOpOrd -&gt; Distance d a -&gt; Distance d a -&gt; Bool
forall b. Ord b =&gt; FilterOpOrd -&gt; b -&gt; b -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Ord.html#toFun"><span class="hs-identifier hs-var">Ord.toFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728097"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679728096"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">distance</span><span> </span><span class="annot"><span class="annottext">Distance d a
</span><a href="#local-6989586621679728104"><span class="hs-identifier hs-var">fDist'</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><a href="#local-6989586621679728104"><span class="hs-identifier hs-type">fDist'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Data.Distance.html#Distance"><span class="hs-identifier hs-type">Distance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728094"><span class="hs-identifier hs-type">activityDist</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-427"></span><span>        </span><span id="local-6989586621679728104"><span class="annot"><span class="annottext">fDist' :: Distance d a
</span><a href="#local-6989586621679728104"><span class="hs-identifier hs-var hs-var">fDist'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sing d -&gt; (SingI d =&gt; Distance d a) -&gt; Distance d a
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679728095"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">((SingI d =&gt; Distance d a) -&gt; Distance d a)
-&gt; (SingI d =&gt; Distance d a) -&gt; Distance d a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a.
(SingI d, ConvertDistance a, ToConstraints a d) =&gt;
a -&gt; ConvertedDistance a d
SomeDistance a -&gt; ConvertedDistance (SomeDistance a) d
forall (e :: DistanceUnit) -&gt;
forall a.
(SingI e, ConvertDistance a, ToConstraints a e) =&gt;
a -&gt; ConvertedDistance a e
forall a.
(ConvertDistance a, ToConstraints a d) =&gt;
a -&gt; ConvertedDistance a d
</span><a href="Pacer.Data.Distance.Units.html#convertDistance"><span class="hs-identifier hs-var">DistU.convertDistance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728094"><span class="hs-identifier hs-type">activityDist</span></a></span><span> </span><span class="annot"><span class="annottext">SomeDistance a
</span><a href="#local-6989586621679728098"><span class="hs-identifier hs-var">fDist</span></a></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="#local-6989586621679728038"><span class="hs-identifier hs-type">applyDur</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Ord.html#FilterOpOrd"><span class="hs-identifier hs-type">FilterOpOrd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Data.Duration.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621679728038"><span class="annot"><span class="annottext">applyDur :: SomeActivity a -&gt; FilterOpOrd -&gt; Duration a -&gt; Bool
</span><a href="#local-6989586621679728038"><span class="hs-identifier hs-var hs-var">applyDur</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679728114"><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679728114"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679728115"><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728115"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilterOpOrd -&gt; Duration a -&gt; Duration a -&gt; Bool
forall b. Ord b =&gt; FilterOpOrd -&gt; b -&gt; b -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Ord.html#toFun"><span class="hs-identifier hs-var">Ord.toFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728115"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><a href="#local-6989586621679728114"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">duration</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><a href="#local-6989586621679728042"><span class="hs-identifier hs-type">applyPace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#SomeActivity"><span class="hs-identifier hs-type">SomeActivity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Command.Chart.Data.Expr.Ord.html#FilterOpOrd"><span class="hs-identifier hs-type">FilterOpOrd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Data.Pace.html#SomePace"><span class="hs-identifier hs-type">SomePace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-433"></span><span>    </span><span id="local-6989586621679728042"><span class="annot"><span class="annottext">applyPace :: SomeActivity a -&gt; FilterOpOrd -&gt; SomePace a -&gt; Bool
</span><a href="#local-6989586621679728042"><span class="hs-identifier hs-var hs-var">applyPace</span></a></span></span><span> </span><span id="local-6989586621679728116"><span class="annot"><span class="annottext">someActivity :: SomeActivity a
</span><a href="#local-6989586621679728116"><span class="hs-identifier hs-var">someActivity</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Command.Chart.Data.Activity.html#MkSomeActivity"><span class="hs-identifier hs-type">MkSomeActivity</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Activity d a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679728117"><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728117"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Pace.html#MkSomePace"><span class="hs-identifier hs-type">MkSomePace</span></a></span><span> </span><span id="local-6989586621679728123"><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679728123"><span class="hs-identifier hs-var">sfp</span></a></span></span><span> </span><span id="local-6989586621679728124"><span class="annot"><span class="annottext">Pace d a
</span><a href="#local-6989586621679728124"><span class="hs-identifier hs-var">fPace</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-434"></span><span>      </span><span class="hs-comment">-- 1. convert someActivity to activityPace</span><span>
</span><span id="line-435"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeActivity a -&gt; SomePace a
forall a.
(From&#8484; a, Ord a, Semifield a, Show a) =&gt;
SomeActivity a -&gt; SomePace a
</span><a href="Pacer.Command.Chart.Data.Activity.html#deriveSomePace"><span class="hs-identifier hs-var">Activity.deriveSomePace</span></a></span><span> </span><span class="annot"><span class="annottext">SomeActivity a
</span><a href="#local-6989586621679728116"><span class="hs-identifier hs-var">someActivity</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-436"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Data.Pace.html#MkSomePace"><span class="hs-identifier hs-type">MkSomePace</span></a></span><span> </span><span class="hs-glyph">@</span><span id="local-6989586621679728127"><span class="annot"><a href="#local-6989586621679728127"><span class="hs-identifier hs-type hs-type">activityDist</span></a></span></span><span> </span><span id="local-6989586621679728128"><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679728128"><span class="hs-identifier hs-var">srp</span></a></span></span><span> </span><span id="local-6989586621679728129"><span class="annot"><span class="annottext">Pace d a
</span><a href="#local-6989586621679728129"><span class="hs-identifier hs-var">activityPace</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-437"></span><span>          </span><span class="hs-comment">-- 2. convert filterPace to activityPace's units</span><span>
</span><span id="line-438"></span><span>          </span><span class="annot"><span class="annottext">Sing d -&gt; (SingI d =&gt; Bool) -&gt; Bool
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679728128"><span class="hs-identifier hs-var">srp</span></a></span><span>
</span><span id="line-439"></span><span>            </span><span class="annot"><span class="annottext">((SingI d =&gt; Bool) -&gt; Bool) -&gt; (SingI d =&gt; Bool) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sing d -&gt; (SingI d =&gt; Bool) -&gt; Bool
forall {k} (n :: k) r. Sing n -&gt; (SingI n =&gt; r) -&gt; r
</span><a href="file:///nix/store/l8y6b4ahaj66wmcdgqd7yhm5r91zplqs-singletons-3.0.4-doc/share/doc/singletons-3.0.4/html/src/Data.Singletons.html/Data.Singletons.html#withSingI"><span class="hs-identifier hs-var">withSingI</span></a></span><span> </span><span class="annot"><span class="annottext">Sing d
</span><a href="#local-6989586621679728123"><span class="hs-identifier hs-var">sfp</span></a></span><span>
</span><span id="line-440"></span><span>            </span><span class="annot"><span class="annottext">((SingI d =&gt; Bool) -&gt; Bool) -&gt; (SingI d =&gt; Bool) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a.
(SingI d, ConvertDistance a, ToConstraints a d) =&gt;
a -&gt; ConvertedDistance a d
Pace d a -&gt; ConvertedDistance (Pace d a) d
forall (e :: DistanceUnit) -&gt;
forall a.
(SingI e, ConvertDistance a, ToConstraints a e) =&gt;
a -&gt; ConvertedDistance a e
forall a.
(ConvertDistance a, ToConstraints a d) =&gt;
a -&gt; ConvertedDistance a d
</span><a href="Pacer.Data.Distance.Units.html#convertDistance"><span class="hs-identifier hs-var">DistU.convertDistance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679728127"><span class="hs-identifier hs-type">activityDist</span></a></span><span> </span><span class="annot"><span class="annottext">Pace d a
</span><a href="#local-6989586621679728124"><span class="hs-identifier hs-var">fPace</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-441"></span><span>              </span><span id="local-6989586621679728139"><span class="annot"><span class="annottext">ConvertedDistance (Pace d a) d
</span><a href="#local-6989586621679728139"><span class="hs-identifier hs-var">fPace'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilterOpOrd -&gt; Pace d a -&gt; Pace d a -&gt; Bool
forall b. Ord b =&gt; FilterOpOrd -&gt; b -&gt; b -&gt; Bool
</span><a href="Pacer.Command.Chart.Data.Expr.Ord.html#toFun"><span class="hs-identifier hs-var">Ord.toFun</span></a></span><span> </span><span class="annot"><span class="annottext">FilterOpOrd
</span><a href="#local-6989586621679728117"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Pace d a
</span><a href="#local-6989586621679728129"><span class="hs-identifier hs-var">activityPace</span></a></span><span> </span><span class="annot"><span class="annottext">ConvertedDistance (Pace d a) d
Pace d a
</span><a href="#local-6989586621679728139"><span class="hs-identifier hs-var">fPace'</span></a></span><span>
</span><span id="line-442"></span></pre></body></html>