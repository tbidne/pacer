<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Pacer.Utils.html"><span class="hs-identifier">Pacer.Utils</span></a></span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * JSON</span></span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Encoding</span></span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#encodeMaybe"><span class="hs-identifier">encodeMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#encodeMonoid"><span class="hs-identifier">encodeMonoid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#encodeMaybes"><span class="hs-identifier">encodeMaybes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#encodePretty"><span class="hs-identifier">encodePretty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Decoding</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#.%3A%3F%3A"><span class="hs-operator">(.:?:)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#failUnknownFields"><span class="hs-identifier">failUnknownFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#decodeJson"><span class="hs-identifier">decodeJson</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#AesonE"><span class="hs-identifier">AesonE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#readDecodeJson"><span class="hs-identifier">readDecodeJson</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Seq</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#seqGroupBy"><span class="hs-identifier">seqGroupBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#neSeqGroupBy"><span class="hs-identifier">neSeqGroupBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Optics</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#SomeSetter"><span class="hs-identifier">SomeSetter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#setMany%27"><span class="hs-identifier">setMany'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Misc</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#PaceMetersErrMsg"><span class="hs-identifier">PaceMetersErrMsg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#Key"><span class="hs-identifier">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#%3C%3F%3E"><span class="hs-operator">(&lt;?&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.html/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Asn</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html"><span class="hs-identifier">Data.Aeson.Encode.Pretty</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#Config"><span class="hs-identifier">Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#confIndent"><span class="hs-identifier">confIndent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#confTrailingNewline"><span class="hs-identifier">confTrailingNewline</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#Indent"><span class="hs-identifier">Indent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#Spaces"><span class="hs-identifier">Spaces</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html"><span class="hs-identifier">Data.Aeson.Encode.Pretty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AsnPretty</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Key</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html/Data.Aeson.KeyMap.html"><span class="hs-identifier">Data.Aeson.KeyMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier">KeyMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html/Data.Aeson.KeyMap.html"><span class="hs-identifier">Data.Aeson.KeyMap</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KM</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.html/Data.Aeson.Types.html"><span class="hs-identifier">Data.Aeson.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#JSONPathElement"><span class="hs-identifier">JSONPathElement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Key"><span class="hs-identifier">Key</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Pair"><span class="hs-identifier">Pair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.html/Data.Aeson.Types.html"><span class="hs-identifier">Data.Aeson.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AsnT</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/w64pacpb44c23dcf9np8yjf0gynlcqja-unordered-containers-0.2.20-doc/share/doc/unordered-containers-0.2.20/html/src/Data.HashMap.Strict.html/Data.HashMap.Strict.html"><span class="hs-identifier">Data.HashMap.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HMap</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/w64pacpb44c23dcf9np8yjf0gynlcqja-unordered-containers-0.2.20-doc/share/doc/unordered-containers-0.2.20/html/src/Data.HashSet.html/Data.HashSet.html"><span class="hs-identifier">Data.HashSet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HSet</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.html/Data.Sequence.NonEmpty.html"><span class="hs-identifier">Data.Sequence.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NESeq</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/fs-utils-0.1-98c482801d5ef5925933b0f33e814691f8f0113763e0f5183e0d5b691f3f61e1/share/doc/html/src/FileSystem.OsPath.html/FileSystem.OsPath.html"><span class="hs-identifier">FileSystem.OsPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/fs-utils-0.1-98c482801d5ef5925933b0f33e814691f8f0113763e0f5183e0d5b691f3f61e1/share/doc/html/src/FileSystem.OsPath.html/FileSystem.OsPath.html#decodeLenient"><span class="hs-identifier">decodeLenient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.IsList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Item</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.IsList</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IL</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Class.Parser.html"><span class="hs-identifier">Pacer.Class.Parser</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Pacer.Prelude.html"><span class="hs-identifier">Pacer.Prelude</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><span class="hs-comment">-- | Encodes 'Maybe's to a possibly empty list.</span></span><span>
</span><span id="line-57"></span><span id="local-6989586621679712302"><span class="annot"><a href="Pacer.Utils.html#encodeMaybes"><span class="hs-identifier hs-type">encodeMaybes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712302"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tuple2</span></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679712302"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List</span></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span></span><span>
</span><span id="line-58"></span><span id="encodeMaybes"><span class="annot"><span class="annottext">encodeMaybes :: forall v. ToJSON v =&gt; [(Key, Maybe v)] -&gt; [Pair]
</span><a href="Pacer.Utils.html#encodeMaybes"><span class="hs-identifier hs-var hs-var">encodeMaybes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Key, Maybe v)] -&gt; ((Key, Maybe v) -&gt; [Pair]) -&gt; [Pair]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Key, Maybe v) -&gt; [Pair]
forall v. ToJSON v =&gt; (Key, Maybe v) -&gt; [Pair]
</span><a href="Pacer.Utils.html#encodeMaybe"><span class="hs-identifier hs-var">encodeMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><span class="hs-comment">-- | Encodes a 'Monoid' to a possibly empty list.</span></span><span>
</span><span id="line-61"></span><span id="local-6989586621679712310"><span class="annot"><a href="Pacer.Utils.html#encodeMonoid"><span class="hs-identifier hs-type">encodeMonoid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679712310"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679712310"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712310"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tuple2</span></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712310"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List</span></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span></span><span>
</span><span id="line-62"></span><span id="encodeMonoid"><span class="annot"><span class="annottext">encodeMonoid :: forall v. (Eq v, Monoid v, ToJSON v) =&gt; (Key, v) -&gt; [Pair]
</span><a href="Pacer.Utils.html#encodeMonoid"><span class="hs-identifier hs-var hs-var">encodeMonoid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Key, Maybe v) -&gt; [Pair]
forall v. ToJSON v =&gt; (Key, Maybe v) -&gt; [Pair]
</span><a href="Pacer.Utils.html#encodeMaybe"><span class="hs-identifier hs-var">encodeMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">((Key, Maybe v) -&gt; [Pair])
-&gt; ((Key, v) -&gt; (Key, Maybe v)) -&gt; (Key, v) -&gt; [Pair]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; Maybe v) -&gt; (Key, v) -&gt; (Key, Maybe v)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; Maybe v
forall {a}. (Eq a, Monoid a) =&gt; a -&gt; Maybe a
</span><a href="#local-6989586621679712557"><span class="hs-identifier hs-var">toMaybe</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621679712557"><span class="annot"><span class="annottext">toMaybe :: a -&gt; Maybe a
</span><a href="#local-6989586621679712557"><span class="hs-identifier hs-var hs-var">toMaybe</span></a></span></span><span> </span><span id="local-6989586621679712565"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712565"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-65"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712565"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-66"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712565"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><span class="hs-comment">-- | Encodes a 'Maybe' to a possibly empty list.</span></span><span>
</span><span id="line-69"></span><span id="local-6989586621679712309"><span class="annot"><a href="Pacer.Utils.html#encodeMaybe"><span class="hs-identifier hs-type">encodeMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712309"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tuple2</span></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679712309"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List</span></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span></span><span>
</span><span id="line-70"></span><span id="encodeMaybe"><span class="annot"><span class="annottext">encodeMaybe :: forall v. ToJSON v =&gt; (Key, Maybe v) -&gt; [Pair]
</span><a href="Pacer.Utils.html#encodeMaybe"><span class="hs-identifier hs-var hs-var">encodeMaybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe v
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Pacer.Utils.html#encodeMaybe"><span class="hs-identifier hs-var">encodeMaybe</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679712572"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679712572"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679712573"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679712573"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679712572"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; v -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679712573"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">type</span><span> </span><span id="PaceMetersErrMsg"><span class="annot"><a href="Pacer.Utils.html#PaceMetersErrMsg"><span class="hs-identifier hs-var">PaceMetersErrMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Meters are disallowed in Pace; use km or mi.&quot;</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="Pacer.Utils.html#seqGroupBy"><span class="hs-identifier hs-type">seqGroupBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679712333"><span class="annot"><a href="#local-6989586621679712333"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679712333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679712333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679712333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712333"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span id="seqGroupBy"><span class="annot"><span class="annottext">seqGroupBy :: forall a. (a -&gt; a -&gt; Bool) -&gt; Seq a -&gt; Seq (NESeq a)
</span><a href="Pacer.Utils.html#seqGroupBy"><span class="hs-identifier hs-var hs-var">seqGroupBy</span></a></span></span><span> </span><span id="local-6989586621679712575"><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679712575"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq a -&gt; Seq (NESeq a)
</span><a href="#local-6989586621679712576"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="#local-6989586621679712576"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679712333"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712333"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679712576"><span class="annot"><span class="annottext">go :: Seq a -&gt; Seq (NESeq a)
</span><a href="#local-6989586621679712576"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><span class="hs-identifier hs-var">Seq.Empty</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (NESeq a)
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.Empty</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="#local-6989586621679712576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679712578"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712578"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span> </span><span id="local-6989586621679712580"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712580"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712578"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Seq a -&gt; NESeq a
forall a. a -&gt; Seq a -&gt; NESeq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-var">:&lt;||</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712582"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NESeq a -&gt; Seq (NESeq a) -&gt; Seq (NESeq a)
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">:&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Seq a -&gt; Seq (NESeq a)
</span><a href="#local-6989586621679712576"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712583"><span class="hs-identifier hs-var">zs</span></a></span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679712582"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712582"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679712583"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712583"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)
</span><span class="hs-identifier hs-var">Seq.spanl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679712575"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712578"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712580"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Pacer.Utils.html#neSeqGroupBy"><span class="hs-identifier hs-type">neSeqGroupBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679712341"><span class="annot"><a href="#local-6989586621679712341"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679712341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679712341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712341"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span id="neSeqGroupBy"><span class="annot"><span class="annottext">neSeqGroupBy :: forall a. (a -&gt; a -&gt; Bool) -&gt; NESeq a -&gt; NESeq (NESeq a)
</span><a href="Pacer.Utils.html#neSeqGroupBy"><span class="hs-identifier hs-var hs-var">neSeqGroupBy</span></a></span></span><span> </span><span id="local-6989586621679712585"><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679712585"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NESeq a -&gt; NESeq (NESeq a)
</span><a href="#local-6989586621679712586"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="#local-6989586621679712586"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#NESeq"><span class="hs-identifier hs-type">NESeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712341"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679712586"><span class="annot"><span class="annottext">go :: NESeq a -&gt; NESeq (NESeq a)
</span><a href="#local-6989586621679712586"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679712587"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712587"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-type">:&lt;||</span></a></span><span> </span><span id="local-6989586621679712588"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712588"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NESeq a
</span><a href="#local-6989586621679712589"><span class="hs-identifier hs-var">fstGrp</span></a></span><span> </span><span class="annot"><span class="annottext">NESeq a -&gt; Seq (NESeq a) -&gt; NESeq (NESeq a)
forall a. a -&gt; Seq a -&gt; NESeq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-var">:&lt;||</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (NESeq a)
</span><a href="#local-6989586621679712590"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679712591"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712591"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679712592"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712592"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)
</span><span class="hs-identifier hs-var">Seq.spanl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679712585"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712587"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712588"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span id="local-6989586621679712589"><span class="annot"><span class="annottext">fstGrp :: NESeq a
</span><a href="#local-6989586621679712589"><span class="hs-identifier hs-var hs-var">fstGrp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712587"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Seq a -&gt; NESeq a
forall a. a -&gt; Seq a -&gt; NESeq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-var">:&lt;||</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712591"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span id="local-6989586621679712590"><span class="annot"><span class="annottext">rest :: Seq (NESeq a)
</span><a href="#local-6989586621679712590"><span class="hs-identifier hs-var hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712592"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-93"></span><span>          </span><span class="annot"><span class="annottext">Seq a
</span><span class="hs-identifier hs-var">Seq.Empty</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (NESeq a)
forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.Empty</span></span><span>
</span><span id="line-94"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679712593"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712593"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span> </span><span id="local-6989586621679712594"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712594"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NESeq (NESeq a) -&gt; Seq (NESeq a)
forall a. NESeq a -&gt; Seq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#toSeq"><span class="hs-identifier hs-var">NESeq.toSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NESeq a -&gt; NESeq (NESeq a)
</span><a href="#local-6989586621679712586"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679712593"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Seq a -&gt; NESeq a
forall a. a -&gt; Seq a -&gt; NESeq a
</span><a href="file:///nix/store/n2pn8j7bicypyy4x21n1q3bp7xhvaibp-nonempty-containers-0.3.4.5-doc/share/doc/nonempty-containers-0.3.4.5/html/src/Data.Sequence.NonEmpty.Internal.html/Data.Sequence.NonEmpty.Internal.html#%3A%3C%7C%7C"><span class="hs-operator hs-var">:&lt;||</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679712594"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | We use this rather than aeson's AesonException for two reasons:</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- 1. AesonException does not have an NFData instance, which we require for</span><span>
</span><span id="line-99"></span><span class="hs-comment">--    the benchmarks.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- 2. Optional path improves the error message.</span><span>
</span><span id="line-102"></span><span class="hs-keyword">data</span><span> </span><span id="AesonE"><span class="annot"><a href="Pacer.Utils.html#AesonE"><span class="hs-identifier hs-var">AesonE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkAesonE"><span class="annot"><a href="Pacer.Utils.html#MkAesonE"><span class="hs-identifier hs-var">MkAesonE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OsPath</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679712598"><span id="local-6989586621679712600"><span class="annot"><span class="annottext">(forall x. AesonE -&gt; Rep AesonE x)
-&gt; (forall x. Rep AesonE x -&gt; AesonE) -&gt; Generic AesonE
forall x. Rep AesonE x -&gt; AesonE
forall x. AesonE -&gt; Rep AesonE x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. AesonE -&gt; Rep AesonE x
from :: forall x. AesonE -&gt; Rep AesonE x
$cto :: forall x. Rep AesonE x -&gt; AesonE
to :: forall x. Rep AesonE x -&gt; AesonE
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679712606"><span id="local-6989586621679712614"><span id="local-6989586621679712618"><span class="annot"><span class="annottext">Int -&gt; AesonE -&gt; ShowS
[AesonE] -&gt; ShowS
AesonE -&gt; String
(Int -&gt; AesonE -&gt; ShowS)
-&gt; (AesonE -&gt; String) -&gt; ([AesonE] -&gt; ShowS) -&gt; Show AesonE
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; AesonE -&gt; ShowS
showsPrec :: Int -&gt; AesonE -&gt; ShowS
$cshow :: AesonE -&gt; String
show :: AesonE -&gt; String
$cshowList :: [AesonE] -&gt; ShowS
showList :: [AesonE] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679712624"><span class="annot"><span class="annottext">AesonE -&gt; ()
(AesonE -&gt; ()) -&gt; NFData AesonE
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: AesonE -&gt; ()
rnf :: AesonE -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679712653"><span id="local-6989586621679712657"><span id="local-6989586621679712661"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Pacer.Utils.html#AesonE"><span class="hs-identifier hs-type">AesonE</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679712668"><span class="annot"><span class="annottext">displayException :: AesonE -&gt; String
</span><a href="#local-6989586621679712668"><span class="hs-identifier hs-var hs-var hs-var">displayException</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Utils.html#MkAesonE"><span class="hs-identifier hs-type">MkAesonE</span></a></span><span> </span><span id="local-6989586621679712670"><span class="annot"><span class="annottext">Maybe OsPath
</span><a href="#local-6989586621679712670"><span class="hs-identifier hs-var">mPath</span></a></span></span><span> </span><span id="local-6989586621679712671"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679712671"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe OsPath
</span><a href="#local-6989586621679712670"><span class="hs-identifier hs-var">mPath</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679712672"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679712672"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-111"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error decoding json path '&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>            </span><span class="annot"><span class="annottext">OsPath -&gt; String
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/fs-utils-0.1-98c482801d5ef5925933b0f33e814691f8f0113763e0f5183e0d5b691f3f61e1/share/doc/html/src/FileSystem.OsPath.html/FileSystem.OsPath.html#decodeLenient"><span class="hs-identifier hs-var">decodeLenient</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679712672"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;': &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>            </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679712671"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-115"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><span class="annottext">Maybe OsPath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error decoding json: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679712671"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><span class="hs-comment">-- | Decodes a json(c) file.</span></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Pacer.Utils.html#readDecodeJson"><span class="hs-identifier hs-type">readDecodeJson</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679712378"><span class="annot"><a href="#local-6989586621679712378"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679712376"><span class="annot"><a href="#local-6989586621679712376"><span class="hs-identifier hs-type">es</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/fs-effectful-0.1-e36fc806e7c6a22475c146f14f54ce4000691b2d7fbb3fd2cec90d44aa064737/share/doc/html/src/Effectful.FileSystem.FileReader.Dynamic.html/Effectful.FileSystem.FileReader.Dynamic.html#FileReader"><span class="hs-identifier hs-type">FileReader</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Effect.html/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712376"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.FromJSON.html/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712378"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="file:///nix/store/1hak7cv0zdhl1xga54zmrx8mlz5ilw6q-effectful-core-2.5.1.0-doc/share/doc/effectful-core-2.5.1.0/html/src/Effectful.Internal.Monad.html/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712376"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712378"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-127"></span><span id="readDecodeJson"><span class="annot"><span class="annottext">readDecodeJson :: forall a (es :: [Effect]).
(FileReader :&gt; es, FromJSON a, HasCallStack) =&gt;
Path Abs File -&gt; Eff es a
</span><a href="Pacer.Utils.html#readDecodeJson"><span class="hs-identifier hs-var hs-var">readDecodeJson</span></a></span></span><span> </span><span id="local-6989586621679712689"><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679712689"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621679712690"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679712690"><span class="hs-identifier hs-var">contents</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; Eff es ByteString
forall (es :: [Effect]).
(FileReader :&gt; es, HasCallStack) =&gt;
OsPath -&gt; Eff es ByteString
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/fs-effectful-0.1-e36fc806e7c6a22475c146f14f54ce4000691b2d7fbb3fd2cec90d44aa064737/share/doc/html/src/Effectful.FileSystem.FileReader.Dynamic.html/Effectful.FileSystem.FileReader.Dynamic.html#readBinaryFile"><span class="hs-identifier hs-var">readBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679712692"><span class="hs-identifier hs-var">osPath</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="annottext">Result AesonE a -&gt; Eff es a
forall e (m :: * -&gt; *) a.
(Exception e, HasCallStack, MonadThrow m) =&gt;
Result e a -&gt; m a
</span><a href="Pacer.Data.Result.html#throwErr"><span class="hs-identifier hs-var">throwErr</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">(Result AesonE a -&gt; Eff es a) -&gt; Result AesonE a -&gt; Eff es a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(AesonE -&gt; AesonE) -&gt; Result AesonE a -&gt; Result AesonE a
forall a b c. (a -&gt; b) -&gt; Result a c -&gt; Result b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">AesonE -&gt; AesonE
</span><a href="#local-6989586621679712695"><span class="hs-identifier hs-var">toAesonPathE</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">(Result AesonE a -&gt; Result AesonE a)
-&gt; Result AesonE a -&gt; Result AesonE a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; ByteString -&gt; Result AesonE a
</span><a href="Pacer.Utils.html#decodeJson"><span class="hs-identifier hs-var">decodeJson</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679712378"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679712690"><span class="hs-identifier hs-var">contents</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679712692"><span class="annot"><span class="annottext">osPath :: OsPath
</span><a href="#local-6989586621679712692"><span class="hs-identifier hs-var hs-var">osPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; OsPath
forall b t. Path b t -&gt; OsPath
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.1-0348/fs-utils-0.1-98c482801d5ef5925933b0f33e814691f8f0113763e0f5183e0d5b691f3f61e1/share/doc/html/src/FileSystem.Path.html/FileSystem.Path.html#toOsPath"><span class="hs-identifier hs-var">toOsPath</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679712689"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679712695"><span class="annot"><span class="annottext">toAesonPathE :: AesonE -&gt; AesonE
</span><a href="#local-6989586621679712695"><span class="hs-identifier hs-var hs-var">toAesonPathE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Utils.html#MkAesonE"><span class="hs-identifier hs-type">MkAesonE</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OsPath
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679712697"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679712697"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe OsPath -&gt; String -&gt; AesonE
</span><a href="Pacer.Utils.html#MkAesonE"><span class="hs-identifier hs-var">MkAesonE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OsPath -&gt; Maybe OsPath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679712692"><span class="hs-identifier hs-var">osPath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679712697"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><span class="hs-comment">-- | Fails if there are any unknown fields in the object.</span></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Pacer.Utils.html#failUnknownFields"><span class="hs-identifier hs-type">failUnknownFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Key label to improve error message.</span></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Known keys.</span></span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">List</span></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Actual keys.</span></span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html/Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KeyMap</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Asn.Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">AsnT.Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span id="failUnknownFields"><span class="annot"><span class="annottext">failUnknownFields :: Key -&gt; [Key] -&gt; KeyMap Value -&gt; Parser ()
</span><a href="Pacer.Utils.html#failUnknownFields"><span class="hs-identifier hs-var hs-var">failUnknownFields</span></a></span></span><span> </span><span id="local-6989586621679712698"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679712698"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679712699"><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679712699"><span class="hs-identifier hs-var">knownKeys</span></a></span></span><span> </span><span id="local-6989586621679712700"><span class="annot"><span class="annottext">KeyMap Value
</span><a href="#local-6989586621679712700"><span class="hs-identifier hs-var">kmap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HashSet Key -&gt; [Key]
forall a. HashSet a -&gt; [a]
</span><a href="file:///nix/store/w64pacpb44c23dcf9np8yjf0gynlcqja-unordered-containers-0.2.20-doc/share/doc/unordered-containers-0.2.20/html/src/Data.HashSet.Internal.html/Data.HashSet.Internal.html#toList"><span class="hs-identifier hs-var">HSet.toList</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet Key
</span><a href="#local-6989586621679712702"><span class="hs-identifier hs-var">unknownKeys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Parser ()
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679712703"><span class="annot"><span class="annottext">unknownKeyList :: [Key]
</span><a href="#local-6989586621679712703"><span class="hs-identifier hs-var">unknownKeyList</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Key]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Parser ()
forall a. String -&gt; Parser a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Encountered unknown keys: &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-152"></span><span>              </span><span class="annot"><span class="annottext">[Key] -&gt; String
</span><a href="#local-6989586621679712704"><span class="hs-identifier hs-var">showKeys</span></a></span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679712703"><span class="hs-identifier hs-var">unknownKeyList</span></a></span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">Parser () -&gt; JSONPathElement -&gt; Parser ()
forall a. Parser a -&gt; JSONPathElement -&gt; Parser a
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#%3C%3F%3E"><span class="hs-operator hs-var">&lt;?&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; JSONPathElement
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Key"><span class="hs-identifier hs-var">Key</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679712698"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679712705"><span class="annot"><span class="annottext">actualKeyMap :: HashMap Key Value
</span><a href="#local-6989586621679712705"><span class="hs-identifier hs-var hs-var">actualKeyMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyMap Value -&gt; HashMap Key Value
forall v. KeyMap v -&gt; HashMap Key v
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.KeyMap.html/Data.Aeson.KeyMap.html#toHashMap"><span class="hs-identifier hs-var">KM.toHashMap</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMap Value
</span><a href="#local-6989586621679712700"><span class="hs-identifier hs-var">kmap</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679712707"><span class="annot"><span class="annottext">actualKeySet :: HashSet Key
</span><a href="#local-6989586621679712707"><span class="hs-identifier hs-var hs-var">actualKeySet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap Key Value -&gt; HashSet Key
forall k a. HashMap k a -&gt; HashSet k
</span><a href="file:///nix/store/w64pacpb44c23dcf9np8yjf0gynlcqja-unordered-containers-0.2.20-doc/share/doc/unordered-containers-0.2.20/html/src/Data.HashSet.Internal.html/Data.HashSet.Internal.html#keysSet"><span class="hs-identifier hs-var">HMap.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Key Value
</span><a href="#local-6989586621679712705"><span class="hs-identifier hs-var">actualKeyMap</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679712709"><span class="annot"><span class="annottext">knownKeySet :: HashSet Key
</span><a href="#local-6989586621679712709"><span class="hs-identifier hs-var hs-var">knownKeySet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Key] -&gt; HashSet Key
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="file:///nix/store/w64pacpb44c23dcf9np8yjf0gynlcqja-unordered-containers-0.2.20-doc/share/doc/unordered-containers-0.2.20/html/src/Data.HashSet.Internal.html/Data.HashSet.Internal.html#fromList"><span class="hs-identifier hs-var">HSet.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Key]
</span><a href="#local-6989586621679712699"><span class="hs-identifier hs-var">knownKeys</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679712702"><span class="annot"><span class="annottext">unknownKeys :: HashSet Key
</span><a href="#local-6989586621679712702"><span class="hs-identifier hs-var hs-var">unknownKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet Key -&gt; HashSet Key -&gt; HashSet Key
forall a. (Eq a, Hashable a) =&gt; HashSet a -&gt; HashSet a -&gt; HashSet a
</span><a href="file:///nix/store/w64pacpb44c23dcf9np8yjf0gynlcqja-unordered-containers-0.2.20-doc/share/doc/unordered-containers-0.2.20/html/src/Data.HashSet.Internal.html/Data.HashSet.Internal.html#difference"><span class="hs-identifier hs-var">HSet.difference</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet Key
</span><a href="#local-6989586621679712707"><span class="hs-identifier hs-var">actualKeySet</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet Key
</span><a href="#local-6989586621679712709"><span class="hs-identifier hs-var">knownKeySet</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="#local-6989586621679712704"><span class="hs-identifier hs-type">showKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">List</span></span><span> </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679712704"><span class="annot"><span class="annottext">showKeys :: [Key] -&gt; String
</span><a href="#local-6989586621679712704"><span class="hs-identifier hs-var hs-var">showKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; ([Key] -&gt; [String]) -&gt; [Key] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.sort</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; ([Key] -&gt; [String]) -&gt; [Key] -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; String) -&gt; [Key] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#toString"><span class="hs-identifier hs-var">Key.toString</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><span class="hs-comment">-- | Decodes json(c).</span></span><span>
</span><span id="line-167"></span><span id="local-6989586621679712403"><span class="annot"><a href="Pacer.Utils.html#decodeJson"><span class="hs-identifier hs-type">decodeJson</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.FromJSON.html/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712403"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Data.Result.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="annot"><a href="Pacer.Utils.html#AesonE"><span class="hs-identifier hs-type">AesonE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712403"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-168"></span><span id="decodeJson"><span class="annot"><span class="annottext">decodeJson :: forall a. FromJSON a =&gt; ByteString -&gt; Result AesonE a
</span><a href="Pacer.Utils.html#decodeJson"><span class="hs-identifier hs-var hs-var">decodeJson</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; AesonE) -&gt; Result String a -&gt; Result AesonE a
forall a b c. (a -&gt; b) -&gt; Result a c -&gt; Result b c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe OsPath -&gt; String -&gt; AesonE
</span><a href="Pacer.Utils.html#MkAesonE"><span class="hs-identifier hs-var">MkAesonE</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OsPath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="annottext">(Result String a -&gt; Result AesonE a)
-&gt; (ByteString -&gt; Result String a) -&gt; ByteString -&gt; Result AesonE a
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">&lt;&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Optic' An_Iso NoIx (Result String a) (Either String a)
-&gt; Either String a -&gt; Result String a
forall k (is :: IxList) t b.
Is k A_Review =&gt;
Optic' k is t b -&gt; b -&gt; t
</span><a href="file:///nix/store/nxp7m462ws2dz3sc7k7vzml10hs63r9x-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Review.html/Optics.Review.html#review"><span class="hs-identifier hs-var">review</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' An_Iso NoIx (Result String a) (Either String a)
</span><span class="">#eitherIso</span></span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="annottext">(Either String a -&gt; Result String a)
-&gt; (ByteString -&gt; Either String a) -&gt; ByteString -&gt; Result String a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String a
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Decoding.html/Data.Aeson.Decoding.html#eitherDecodeStrict"><span class="hs-identifier hs-var">Asn.eitherDecodeStrict</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><span class="annottext">(ByteString -&gt; Result String a)
-&gt; (ByteString -&gt; Result String ByteString)
-&gt; ByteString
-&gt; Result String a
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Result String ByteString
</span><a href="Pacer.Class.Parser.html#stripComments"><span class="hs-identifier hs-var">P.stripComments</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Decodes a json list into an 'IsList'. Like '(.:?)', omitted keys are fine</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- and decode to an empty list.</span><span>
</span><span id="line-176"></span><span class="annot"><a href="Pacer.Utils.html#.%3A%3F%3A"><span class="hs-operator hs-type">(.:?:)</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679712462"><span class="annot"><a href="#local-6989586621679712462"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.FromJSON.html/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Item</span></span><span> </span><span class="annot"><a href="#local-6989586621679712462"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="#local-6989586621679712462"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Asn.Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">AsnT.Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712462"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-182"></span><span id=".%3A%3F%3A"><span class="annot"><span class="annottext">.:?: :: forall l.
(FromJSON (Item l), IsList l) =&gt;
KeyMap Value -&gt; Key -&gt; Parser l
</span><a href="Pacer.Utils.html#.%3A%3F%3A"><span class="hs-operator hs-var hs-var">(.:?:)</span></a></span></span><span> </span><span id="local-6989586621679712747"><span class="annot"><span class="annottext">KeyMap Value
</span><a href="#local-6989586621679712747"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679712748"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679712748"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="annottext">KeyMap Value
</span><a href="#local-6989586621679712747"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMap Value -&gt; Key -&gt; Parser (Maybe [Item l])
forall a. FromJSON a =&gt; KeyMap Value -&gt; Key -&gt; Parser (Maybe a)
</span><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.FromJSON.html/Data.Aeson.Types.FromJSON.html#.%3A%3F"><span class="hs-operator hs-var">.:?</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679712748"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Maybe [Item l]) -&gt; (Maybe [Item l] -&gt; l) -&gt; Parser l
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">Maybe [Item l]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Item l] -&gt; l
forall l. IsList l =&gt; [Item l] -&gt; l
</span><span class="hs-identifier hs-var">IL.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679712750"><span class="annot"><span class="annottext">[Item l]
</span><a href="#local-6989586621679712750"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Item l] -&gt; l
forall l. IsList l =&gt; [Item l] -&gt; l
</span><span class="hs-identifier hs-var">IL.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Item l]
</span><a href="#local-6989586621679712750"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="Pacer.Utils.html#.%3A%3F%3A"><span class="hs-operator hs-type">.:?:</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621679712471"><span class="annot"><a href="Pacer.Utils.html#encodePretty"><span class="hs-identifier hs-type">encodePretty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/11xdxvwjh511a6hif7hb1d40k6pamrqf-aeson-2.2.3.0-doc/share/doc/aeson-2.2.3.0/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712471"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679712471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Pacer.Prelude.html#LazyByteString"><span class="hs-identifier hs-type">LazyByteString</span></a></span></span><span>
</span><span id="line-190"></span><span id="encodePretty"><span class="annot"><span class="annottext">encodePretty :: forall a. ToJSON a =&gt; a -&gt; LazyByteString
</span><a href="Pacer.Utils.html#encodePretty"><span class="hs-identifier hs-var hs-var">encodePretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; a -&gt; LazyByteString
forall a. ToJSON a =&gt; Config -&gt; a -&gt; LazyByteString
</span><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#encodePretty%27"><span class="hs-identifier hs-var">AsnPretty.encodePretty'</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679712754"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679712754"><span class="annot"><span class="annottext">cfg :: Config
</span><a href="#local-6989586621679712754"><span class="hs-identifier hs-var hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><span class="annottext">Config
</span><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#defConfig"><span class="hs-identifier hs-var">AsnPretty.defConfig</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#confIndent"><span class="hs-identifier hs-var">confIndent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#Spaces"><span class="hs-identifier hs-type">Spaces</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">,</span><span>
</span><span id="line-195"></span><span>          </span><span class="annot"><a href="file:///nix/store/danimg4lh0h0wfxfvlq21012winvi6pc-aeson-pretty-0.8.10-doc/share/doc/aeson-pretty-0.8.10/html/src/Data.Aeson.Encode.Pretty.html/Data.Aeson.Encode.Pretty.html#confTrailingNewline"><span class="hs-identifier hs-var">confTrailingNewline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><span class="hs-comment">-- | Existential wrapper for an optic setter with new object.</span></span><span>
</span><span id="line-199"></span><span class="hs-keyword">data</span><span> </span><span id="SomeSetter"><span class="annot"><a href="Pacer.Utils.html#SomeSetter"><span class="hs-identifier hs-var">SomeSetter</span></a></span></span><span> </span><span id="local-6989586621679712756"><span class="annot"><a href="#local-6989586621679712756"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>  </span><span id="MkSomeSetter"><span class="annot"><a href="Pacer.Utils.html#MkSomeSetter"><span class="hs-identifier hs-var">MkSomeSetter</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679712758"><span class="annot"><a href="#local-6989586621679712758"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679712759"><span class="annot"><a href="#local-6989586621679712759"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679712760"><span class="annot"><a href="#local-6989586621679712760"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679712761"><span class="annot"><a href="#local-6989586621679712761"><span class="hs-identifier hs-type">ix</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/nxp7m462ws2dz3sc7k7vzml10hs63r9x-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Internal.Optic.Subtyping.html/Optics.Internal.Optic.Subtyping.html#Is"><span class="hs-identifier hs-type">Is</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712760"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/nxp7m462ws2dz3sc7k7vzml10hs63r9x-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Internal.Optic.Types.html/Optics.Internal.Optic.Types.html#A_Setter"><span class="hs-identifier hs-type">A_Setter</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="file:///nix/store/nxp7m462ws2dz3sc7k7vzml10hs63r9x-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Internal.Optic.html/Optics.Internal.Optic.html#Optic"><span class="hs-identifier hs-type">Optic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712760"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712761"><span class="hs-identifier hs-type">ix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712758"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712758"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712759"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712759"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="#local-6989586621679712759"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="Pacer.Utils.html#SomeSetter"><span class="hs-identifier hs-type">SomeSetter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712758"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Targets some object using a list of optics and the new values.</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- Equivalent to calling set' multiple times.</span><span>
</span><span id="line-209"></span><span class="annot"><a href="Pacer.Utils.html#setMany%27"><span class="hs-identifier hs-type">setMany'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679712477"><span class="annot"><a href="#local-6989586621679712477"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679712478"><span class="annot"><a href="#local-6989586621679712478"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679712477"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="#local-6989586621679712477"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Utils.html#SomeSetter"><span class="hs-identifier hs-type">SomeSetter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679712478"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="#local-6989586621679712478"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><a href="#local-6989586621679712478"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-215"></span><span id="setMany%27"><span class="annot"><span class="annottext">setMany' :: forall (f :: * -&gt; *) p. Foldable f =&gt; f (SomeSetter p) -&gt; p -&gt; p
</span><a href="Pacer.Utils.html#setMany%27"><span class="hs-identifier hs-var hs-var">setMany'</span></a></span></span><span> </span><span id="local-6989586621679712764"><span class="annot"><span class="annottext">f (SomeSetter p)
</span><a href="#local-6989586621679712764"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679712765"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679712765"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(p -&gt; SomeSetter p -&gt; p) -&gt; p -&gt; f (SomeSetter p) -&gt; p
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; f a -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679712767"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679712767"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Pacer.Utils.html#MkSomeSetter"><span class="hs-identifier hs-type">MkSomeSetter</span></a></span><span> </span><span id="local-6989586621679712770"><span class="annot"><span class="annottext">Optic k ix p p x x
</span><a href="#local-6989586621679712770"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679712771"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679712771"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Optic k ix p p x x -&gt; x -&gt; p -&gt; p
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///nix/store/nxp7m462ws2dz3sc7k7vzml10hs63r9x-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Setter.html/Optics.Setter.html#set%27"><span class="hs-identifier hs-var">set'</span></a></span><span> </span><span class="annot"><span class="annottext">Optic k ix p p x x
</span><a href="#local-6989586621679712770"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679712771"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679712767"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679712765"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">f (SomeSetter p)
</span><a href="#local-6989586621679712764"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-216"></span></pre></body></html>